{deck}
version:1
card:0
size:[512,342]
name:"palimport.deck"
patterns:"%%IMG3AAgA5ggAAQgcSLCgwYMIEypMGKChw4cQI0qcSLFixYMBMGKUSDCjQY8FQU4UCHJgSZIbQ6JcSbLhx5cmFyI8CVOmSoUjHQKw6FInxZ09eQLNSNTlSpEdh4r0adIo0qE7W+pkWZJozZkvjUalGpMrS5xdNX5lGHZjUZ89oUJUq/YhW7Rwo9KkaZPu1qtiweKFGtbjSa0h7Vodi/Rp37t/YxrmanVwY6Bytz5O6zgyZcmW7SYdexPrXc9fAX/02xSyVr+aIbdUqtryZ5WPscbWOHt0RNc/J+fMzFE3R7NrgbsVPjUr7uOTkStPnhyx182Yj3Zd7LXwWdNB27pF27Y73Livw4Muy3ku3rPfL95ev5b99uGcYUeWmdq5XqVLg6JfLfU0fO1PXaYZdfNVFxh5WVXVmlwK3kabe+8R9M+ELojwQhEp/KAHDEVk0kMQzaDRwz65UCEPO4vAksohmfwxhxlZkEEEDkZcAUYaeChySCqyiDJQQA=="

{card:home}
image:"%%IMG3AgABVgKEj6nL7Q+jnLTai7PevPsPhuJIluaJpurKtu4Lx/JM1/aN5/rO9/4PDAqHxKLxiEwql8ym8wmNSqfUqvWKzWq33K73Cw6Lx+Sy+YxOq9fstvsNj8vn9Lr9js/r9/y+/w8YKDhIWGh4iJiouMjY6PgIGSk5SVlpeYmZqbnJ2en5CRoqOkpaanqKmqq6ytrq+gobKztLW2t7i5uru8vb6/sLHCw8TFxsfIycrLzM3Oz8DB0tPU1dbX2Nna29zd3t/Q0eLj5OXm5+jp6uvs7e7v4OHy8/T19vf4+fr7/P3+//DzCgwIEECxo8iDChwoUMGzp8CDGixIkUK1q8iDGjxo0cO3r8CDKkyJEkS5o8iTKlypUsW7p8CTOmzJk0a9q8iTOnzp08e/r8CTSo0KFEixo9ijSp0qVDAjh9CjUq009Rq1q9KnWqJqxcu0LVismr2K5gK409e7UsJbQPyKptxfWtK6xy51qtC7cqXrtP9+b96leV3sCCARNGNfiwqcSKS2Vt7Ngw5FGPJ4uqbJkq5sydGHPuLPkz6L6iNZMuPdop6tSqV2/y7Nrs5thrZ9OWZPt2pNy6H/HuzQg2cN+/hyMSbnzQ6QPIkwPCXNw5H+ihpQuq3Nx6H+zRteN5nN37nqx3xSv/Wt78da/qz8dtv54ugurw6cR9X98O2u750+yn398b/7UWoH37FXiHWAiOJ9+CDPLnYBzLRUhhhRZeiGGGGm7IYYcefghiiCKOSGKJJp6IYooqrshiiy6+CGOMMs5IY4023ohjjjruyGOPPv4IZJBCDklkkUYeiWSSSi7JZJNOPglllFJOSWWVVl6JZZZabslll15+CWaYYo5JZplmnolmmmquyWabbr4JZ5xyzklnnXbeiWeeeu7JZ59+/glooIIOSmihhh6KaKKKLspoo44+Cmmkkk5KaaWWXopppppuymmnnn4Kaqiijkpqqaaeimqqqq7KaquuvgprrLLOSmuttt6Ka6667sprr77+Cmywwg5LbLHGHotsssouy2yzzj4LbbTSTkttNgUA"
{widgets}
palImport1:{"type":"contraption","size":[137,100],"pos":[334,171],"def":"palImport","widgets":{"button1":{},"button2":{},"p":{"value":"2e222f\n45293f\n7a3045\n993d41\ncd683d\nfbb954\nf2ec8b\nb0a987\n997f73\n665964\n443846\n576069\n788a87\na9b2a2\n"}}}
canvas1:{"type":"canvas","size":[150,150],"pos":[47,49],"pattern":47,"image":"%%IMG3AJYAlgZAgHBILBqPyKRyyWw6n9CodEqtWq/YrHbL7Xq3pbB4TC6bx9+0mthqu9/wuPx9rpfW+O98z4fbz3mBW32Ee39mgolXhYx+h2SKkVONlC2PkJKZTpWNl2iaoEqcjJ5ioadHo4WlYaiuQ6qErHevrrF9s7W2t4asuqi8vaW/p8FzucRPIcvMWMZyyMlNzM2Lz47D0tPUIc7XdL7aTNzd1t9t0eJJ5N7nluFGL/Lz9PX29/Re7Obn6UT4AAPW08etXT94RQQqBEiQmsFv/oYsnDiwyz4r7tAh/EexY8NqGDNGFNLRo8WC/CBulFhy4sdlD6+NBNDS5UmHTUjo3Mkz47ts8WoqfFmOCc+jJHzOFDr0JsglSHuKXEmSaUCiTqLuVEqVplWGTmHm1Jp0KtCEX/FhHauV61mOae2tNUrWp4i7ePFGiXtvLlSygAOTyEu4cN69fCtyufhXsOOjhiMfhpJY8RbGSh5r3im5M+LK8vxm3qy5s+TPoEUnIV3atGHUlVUjYf3Y9WvKoEOHLdqYNmDbhWEnln3Et2DghIXzHcF8hBbMq43/Rq4Xd+7mzrNAn83ahPfv4MOLHw9eeVzsz1HSJU2+vfvw5tOi166+t+b3+NvH/zofy/bi3eUnYHnWgdZfJrQNqKAJ+1l1oCQJLihgg0w9GEmEEuJHoVAWKoJhhu5tWFOHiXwIInlVYKfiiiy2yFwoJp4oXoou1mhjdprEKCOBU9zoI4swBrjjeDT+aCSOCAo5JHxUHHlkkOwtOWOTTv4I5WZSTtljlT5eeV+WPErBZZfqFAFmmFGMeWOZZp7pXZFqtsgmEW6+SaWRKeSp55589unnnqjUyeCdP/5p6KF8BlonnD4i6qihirrJ6I2PVproKYJOaqOlnKYQ6Zma1tippZ+CGaqLo1Zaapantpjqo6tK2SqLrzoa65KzrlgrorcOmauKux7a646/YhcspJguGsixfw4royDM+jmnNNH2OW0y1V56rS7ZArott93m+S244Y5bS7jimusKup6qiwq77r6LbrynwEsvKPbem0m++kZxwr8AByzwwADz2+8TBCessMEHN6HwwwIz3PASEFd8gsQTJ2ExxBhnfMTGD3fscREgl3zCyIEIjMLKLLfs8sswt4zyFyrHbPPNMs/cRc049wyzzjsH7PPQLgPNBc9ED230Fkgn3fPSWjTt9M1QZyH11DFXjcXVWL+s9RVcd53z11SELfbKZFdh9tlply302Ta3PcXaYmvNwt1456333nznDXfRVfct+OB6/z320oQnLrjhLNut+ON+M46C45BDLvnkgVduueSUa5745Z17PjjomYtOOOm/qKD66qy37vrrrA9h+uecEwP77bi3Lvvso9eeeu7Aw747732jrkvwyOsuBPGL+3588tAPz3zhztcCffTLT7+38dZfj7z02t/NPRUglG+++VV4/3324eM9/hTnx5+++sCDH/77UsR//vz0426/9r/QH/qo0L/c/W96ARQgCPhXwNcdkHkJFCADG6g8ALQvbxHU3wQpuLoHEi+D8iMgB13nQd6BcH8iHGHs2HfBFbjwhTB8oSIUuMAUqlB1JZxdDHfowhkqcIMjzKHpeLhDIrjgiEhMohKXyMQkEoGGQOSgEEVHxBgasYlYzKIThwBFG95wip6rIgyvqMUyMvGJP/SiCsGoOTHKcAhmjKMS0ShBNQaRhe1zYw/hKMc+0lGDdpQiHsOnxxWQsY9m/GMIp3DDFTqhkJC0Ih8RmUguppGRjcThEyLJSUNOkpJaVCQKMZlJKHQykocEJRZFOUBSNtKUpyxkKlV5RkvW0ZVf3GQs9ThLWs7RloDE5Rp1uUsx9tKXSGRl+aJIQVgWs4rHRKYLlFlDYd7xkc+E5ieluUUh0DAI"}
field1:{"type":"field","size":[175,88],"pos":[259,60],"locked":1,"show":"transparent","border":0,"value":{"text":["this deck contains a palette importer contraption that can understand the .hex palettes available on ","lospec.com","\n(up to 16 colors, naturally.)\n\nIt's also a handy regression test for round-tripping custom palettes, which is why it lives here!"],"font":["","",""],"arg":["","https://lospec.com/palette-list",""]}}

{contraption:palImport}
size:[137,100]
margin:[0,0,0,0]
description:"a tool for importing color palettes in the .hex format as used by lospec.com."
image:"%%IMG3AIkAZAQQgECrvTjrzbv/YPhJU2OeaKqubOu+cCzPcVDSeK7vfN9QvqBwSHQBi8ikknZcOp/PJnRKDUqr2Kzsqu16UdyvOBsem6HlszqZXruF7bd8F5/bZ/W73hjY+3N5f4I/fYOGLYGHeomKdoyNco+QbpKTapWWZpiZYpucXp6fWqGiWKSlVKeoaIWri62ujrCxkbO0lLa3l7m6mry9nb/AoMLDo8XGpsjJqcvMrM++0WOq0zrV1jjY2XjO3EXb3zDh4nzlyudV5Okq6+xg3u908fKA9PVM9/hb+vvj/f7MBQQHcOAKd/UQylP4jiE7h+kgnpNYjqI4i98wctOYjaM1j9NARhP5jCQzk8lQGlM5jCUwl71g6pJ5iyYtm7FwutK5iicqn6WAihL6iSgno5mQWlI6yUZBgydsSBBBtarVq1izSogA"
{widgets}
button1:{"type":"button","size":[60,20],"pos":[6,74],"script":"palImport.0p","text":"Import"}
button2:{"type":"button","size":[60,20],"pos":[71,74],"script":"palImport.1p","text":"Apply"}
p:{"type":"field","size":[125,62],"pos":[6,7],"scrollbar":1,"style":"code"}

{script:palImport.0p}
on click do
 p.text:read[]
end
{end}

{script:palImport.1p}
on color_dist a b do
 aa:"%2h%2h%2h" parse "%06h" format a
 bb:"%2h%2h%2h" parse "%06h" format b
 sum(aa-bb)^2
end

on find_closest i n do
 g:patterns[i]
 r:first n
 each v in n
  if color_dist[v g]<color_dist[r g] r:v end
 end
 patterns[i]:r
 (list r) drop n
end

on click do
 n:16 limit (list "%h") parse "\n" split p.text
 patterns[32]:16777215
 patterns[47]:0
 if 15<count n
  n:find_closest[32 n]
  n:find_closest[47 n]
 end
 each c i in n patterns[33+i]:c end
end
{end}

