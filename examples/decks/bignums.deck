{deck}
version:1
card:0
size:[512,342]
name:"bignums.deck"

{card:Index}
image:"%%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OtW3vAWuXPkVJeKmNTdR1Z9e8zoWqz73T1j17P2iuU3lQra4vFzvU1knV28el1cwlKx8xHtdjgZQtbVlq5VE+tj3Ie5JprXj264ame5Ob4bctNpn4dosgzpVTIUFbDpRS9tptpeoMDoqe427DhOIc5PAwu94SxrIFOIFwGyrcIBHytSfFtjAx+qoCmkR3RGT+FoP1jGKU8zYfLq4xbBcMHoxC2T+sgy8SC5YLVa7PYhK08SgpfGJUxhA6u73cnJpIE1MKsnX4vadT9aAu2q3LtYqWMMQ1uWLodPfIudydDHan4R9jGUy58eh0s3Fe29Lxj/jQ9B+BM+HE5wVQLN5RYyGx3ZvUpI7N3rS9Hh0O/K85UNTetPnsLQ6HAsnTouaLFa+h4hHjWp5lNrUJEi1qz+9anu0+tW0NoenYQ3lWuv6G7fGNYF3DezMuOTXwS62NXrtaxkbe9nRQHayx8zsaB/D2Zd2p7SvvQxqVxur2O42MLQN6dd6e9zz7QlTyY3uMqd73ezObLvfDe+7xHve7AY3ve+9H3vje9+h0Te//80UfwN84B8ROMEPPmyEKzzVBl+4w83z8Ig3uuESr/igY23xjHMI4xrveEIo7vGQd5rjIi85P0Bu8pRnhhEsb7nLXw7zmMt85jSvuc1vjvOc63znPO+5z38O9KALfehEL7rRj470pCt96UxvutOfDvWoS33qVK+61a+O9axrfetc77rXvw72sIt97GQvu9nPjva0q33tbG+7298O97jLfe50r7vd7473vOt973zvu9//DvjAC37whC+84Q+P+MQrfvGMb7zjHw/5yEt+8pSvvOUvj/nMa37znO+85z8P+tCLfvSkL73pT4/61Kt+9axvvetfD/vYy372tK+97W+P+9zrfve8773vfw/84At/+MQvvvGPj/zkK3/5zG++858P/ehLf/rUr771r4/97Gt/+9zvvve/D/7wi3/85C+/+c+P/vSrf/3sb7/73w//+Mt//vSvv/3vj//863///O+///8PgAEogANIgAVogAeIgAmogAvIgA3ogA8IgREogRNIgRVogReIgRmogRvIgR3ogR8IgiEogiNIgiVogieIgimogivIgi3ogi8IgzEogzNIgzVogzeIgzmogzvIgz3ogz8IhEEohENIhEVohEeIhEmohEvIhE3ohE8IhVEohVNIhVVohVeIhVmohVvIhV3ohV8IhmEohmNIhmVohmeIhmmohmvIhm3ohm8Ih3Eoh3NIh3Voh3eIh3moh3vIh33oh38IiIEoiINIiIVoiIeIiImoiIvIiIFYAA=="
script:"Index.0"
{widgets}
field1:{"type":"field","size":[261,14],"pos":[245,109],"locked":1,"show":"invert","border":0,"value":"arbitrary-precision natural number arithmetic for Decker"}
button1:{"type":"button","size":[60,20],"pos":[442,312],"script":"Index.1","text":"Next","style":"rect"}
field2:{"type":"field","size":[248,15],"pos":[14,142],"locked":1,"show":"transparent","border":0,"value":{"text":["","Index:"],"font":["","menu"],"arg":["",""]}}
index:{"type":"field","size":[243,155],"pos":[16,159],"locked":1,"volatile":1,"script":"Index.2","scrollbar":1}
version:{"type":"field","size":[42,14],"pos":[16,318],"locked":1,"volatile":1,"border":0}

{script:Index.0}
on view do
 bullet:image["%%IMG0AAYADQAAAAB49Pz8/HgAAAA="]
 i:select c:key t:value..widgets.title.text where value..widgets.title from deck.cards
 index.value:raze each row in rows i
  rtext.make["" "" bullet],
  rtext.make["  "],
  rtext.make[("%s\n" format row.t) "mono" row.c]
 end
 version.text:"v%0.1f" format deck.modules.bn.version
end
{end}

{script:Index.1}
on click do
 t.Prev:"SlideRight"
 t.Next:"SlideLeft"
 t.Index:"BoxOut"
 go[me.text t[me.text] 15]
end
{end}

{script:Index.2}
on link val do
 go[val "BoxIn" 15]
end
{end}

{card:make}
{widgets}
button1:{"type":"button","size":[60,20],"pos":[442,312],"script":"Index.1","text":"Next","style":"rect"}
button2:{"type":"button","size":[60,20],"pos":[10,312],"script":"Index.1","text":"Prev","style":"rect"}
title:{"type":"field","size":[492,17],"pos":[10,22],"locked":1,"font":"menu","show":"invert","border":1,"align":"center","value":"bn.make[]"}
button3:{"type":"button","size":[60,20],"pos":[78,312],"script":"Index.1","text":"Index","style":"rect"}
field1:{"type":"field","size":[248,238],"pos":[254,48],"locked":1,"border":0,"value":"The natural numbers are unsigned integers, which for our purposes include zero.\n\nThe \"bn\" module represents arbitrary precision natural numbers (bignums) as lists of digits in some radix. The bn.make[] function can convert an ordinary Lil number or a Lil string containing digits into a bignum. The bn.make[] function is an identity function for arguments that are already bignums.\n\nBignums are always made \"normalized\", stripping any leading zeroes; thus the empty list encodes the number zero. When converting strings, non-digit characters are ignored, so literals may optionally include comma separators, leading whitespace, or other non-semantic decoration."}
ex1:{"type":"field","size":[232,238],"pos":[10,48],"border":1,"style":"code","value":"# the following equivalences hold:\n\nbn.make[1234]~bn.make[\"1234\"]\n\nbn.make[bn.make[5]]~bn.make[5]\n\nbn.make[0]~()\n\nbn.make[1234]~bn.make[\"-1,234\"]\n"}

{card:formatting}
image:"%%IMG3AgABVgKEj6nL7Q+jnLTai7PevPsPhuJIluaJpurKtu4Lx/JM1/aN5/rO9/4PDAqHxKLxiEwql8ym8wmNSqfUqvWKzWq33K73Cw6Lx+Sy+YxOq9fstvsNj8vn9Lr9js/r9/y+/w8YKDhIWGh4iJiouMjY6PgIGSk5SVlpeYmZqbnJ2en5CRoqOkpaanqKmqq6ytrq+gobKztLW2t7i5uru8vb6/sLHCw8TFxsfIycrLzM3Oz8DB0tPU1dbX2Nna29zd3t/Q0eLj5OXm5+jp6uvs7e7v4OHy8/T19vf4+fr7/P3+//DzCgwIEECxo8iDChwoUMGzp8CDGixIkUK1q8iDGjxo0cO3r8CDKkyJEkS5o8iTKlypUsW7p8CTOmzJk0a9q8iTOnzp08e/r8CdRagKFEixotGpRWgApLk8pqOgGq01dSI1SdyurqA61YU3Ft8LWrqbALyIodZTZB2rOg1h5wy7YTXABz42qaW9cuJrx6vTLti4ov4LF/B5cSbFjuUaaLE1/K6wCyY0KSFVSePOiyAc2YBV3m3NlzBtChRVsgXdp01NSe3KJmndkq7LZbZ4f6+tp2Ia25de9W65sU1N7BDS0lXtx48uXMmzt/Dj269OnUq1u/jj279u3cu3v/Dj68+PHky5s/jz69+vXs27t/Dz++/Pn069u/jz+//v38+/v/D2CAAg5IYIEGHohgggouyGCDDj4IYYQSTkhhhRZeiGGGGm7IYYcefghiiCKOSGKJJp6IYooq2ndUi42tGANiML4g44wt1GjjCjjmmMKOPJ7g448lBCnkCEQWGcKRSH6g5JIdNOnkBlBGOVphVJIw5ZWnWamllC9K0GKXF7yGnI2klZkjZ2jy+JmYT1bp5ptbxulBlnRC4NqdScqm556R9WkkWIBiWdagQwJn6KGbJQokXYyisOajkk5KaaWWXopppppuymmnnn4Kaqiijkpqqaaeimqqqq7KaquuvgprrLLOSmuttt6Ka6667sprr77+Cmywwg5LbLHGHotsssouy2yzzj4LbbTSTktttdZei2222m7LbbfefgtuuOKOS2655p6Lbrrqrstuu+6+C2+88s5Lb709FAA="
script:"formatting.0"
{widgets}
button1:{"type":"button","size":[60,20],"pos":[442,312],"script":"Index.1","text":"Next","style":"rect"}
button2:{"type":"button","size":[60,20],"pos":[10,312],"script":"Index.1","text":"Prev","style":"rect"}
title:{"type":"field","size":[492,17],"pos":[10,22],"locked":1,"font":"menu","show":"invert","border":1,"align":"center","value":"formatting"}
button3:{"type":"button","size":[60,20],"pos":[78,312],"script":"Index.1","text":"Index","style":"rect"}
field1:{"type":"field","size":[248,238],"pos":[254,48],"locked":1,"border":0,"value":{"text":["Having made bignums, it is important to be able to convert them back into a displayable number. The \"bn\" module offers three variations on converting bignums into strings:\n","\nbn.format_plain[x]\nbn.format_commas[x]\nbn.format_name[x]","\n\nA \"plain\" formatted number is a simple string of digits. A \"commas\" formatted number is displayed with commas between every three digits, to make magnitude clearer. A \"name\" formatted number displays up to the three leading significant figures and an appropriate human-readable name indicating magnitude, for compact display."],"font":["","mono",""],"arg":["","",""]}}
ex1:{"type":"field","size":[232,37],"pos":[10,48],"script":"formatting.1","border":1,"style":"code","value":"71780085"}
field2:{"type":"field","size":[232,37],"pos":[10,249],"locked":1,"volatile":1,"border":1,"style":"code"}
mode:{"type":"grid","size":[100,43],"pos":[81,146],"locked":1,"script":"formatting.2","scrollbar":0,"headers":0,"lines":0,"value":{"value":["format_plain","format_commas","format_name"]},"row":1}

{script:formatting.0}
on view do
 field2.text:bn[first mode.rowvalue][ex1.text]
end
{end}

{script:formatting.1}
on change val do
 view[]
end
{end}

{script:formatting.2}
on click row do
 view[]
end
{end}

{card:logic}
{widgets}
button1:{"type":"button","size":[60,20],"pos":[442,312],"script":"Index.1","text":"Next","style":"rect"}
button2:{"type":"button","size":[60,20],"pos":[10,312],"script":"Index.1","text":"Prev","style":"rect"}
title:{"type":"field","size":[492,17],"pos":[10,22],"locked":1,"font":"menu","show":"invert","border":1,"align":"center","value":"bn.equal[], bn.more[], bn.less[]"}
button3:{"type":"button","size":[60,20],"pos":[78,312],"script":"Index.1","text":"Index","style":"rect"}
field1:{"type":"field","size":[248,238],"pos":[254,48],"locked":1,"border":0,"value":{"text":["The \"bn\" module provides logical comparison functions equivalent to Lil's =, >, and < operators, which return a plain 1 or 0 result:\n\n","bn.equal[x y]\nbn.more[x y]\nbn.less[x y]","\n\nLike all arithmetic operations provided by \"bn\", these functions will automatically coerce their arguments as if with bn.make[]; thus they can be called with any combination of bignums, numbers, or digit-strings."],"font":["","mono",""],"arg":["","",""]}}
ex1:{"type":"field","size":[232,238],"pos":[10,48],"border":1,"style":"code","value":"alert[bn.more[\"1235\" bn.make[1234]]]"}
button4:{"type":"button","size":[60,20],"pos":[254,266],"script":"logic.0","text":"Try It!"}

{script:logic.0}
on click do
 eval[ex1.text () 1]
end
{end}

{card:arith1}
{widgets}
button1:{"type":"button","size":[60,20],"pos":[442,312],"script":"Index.1","text":"Next","style":"rect"}
button2:{"type":"button","size":[60,20],"pos":[10,312],"script":"Index.1","text":"Prev","style":"rect"}
title:{"type":"field","size":[492,17],"pos":[10,22],"locked":1,"font":"menu","show":"invert","border":1,"align":"center","value":"bn.add[], bn.sub[], bn.mul[]"}
button3:{"type":"button","size":[60,20],"pos":[78,312],"script":"Index.1","text":"Index","style":"rect"}
field1:{"type":"field","size":[248,238],"pos":[254,48],"locked":1,"border":0,"value":{"text":["The \"bn\" module provides several arithmetic functions which return bignums, including addition, subtraction, and multiplication:\n\n","bn.add[x y]\nbn.sub[x y]\nbn.mul[x y]","\n\nLike all arithmetic operations provided by \"bn\", these functions will automatically coerce their arguments as if with bn.make[]; thus they can be called with any combination of bignums, numbers, or digit-strings.\n\nBignums cannot represent negative values. If borrowing in bn.sub[] would underflow, the result will be the Lil number \"0\", consistent with undefined arithmetic results for Lil operators, and compatible with the \"unless\" operator for coercing error values."],"font":["","mono",""],"arg":["","",""]}}
ex1:{"type":"field","size":[232,156],"pos":[10,48],"border":1,"style":"code","value":"on factorial x do\n t:bn.make[1]\n each v in 1+range x\n  t:bn.mul[t v]\n end\n t\nend\n\nresult.text:bn.format_commas[\n factorial[69]\n]"}
button4:{"type":"button","size":[60,20],"pos":[254,266],"script":"logic.0","text":"Try It!"}
result:{"type":"field","size":[232,52],"pos":[10,234],"locked":1,"volatile":1,"border":1,"style":"code"}
field2:{"type":"field","size":[232,13],"pos":[10,220],"locked":1,"show":"transparent","border":0,"style":"plain","value":"result"}

{card:div}
image:"%%IMG3AgABVgKEj6nL7Q+jnLTai7PevPsPhuJIluaJpurKtu4Lx/JM1/aN5/rO9/4PDAqHxKLxiEwql8ym8wmNSqfUqvWKzWq33K73Cw6Lx+Sy+YxOq9fstvsNj8vn9Lr9js/r9/y+/w8YKDhIWGh4iJiouMjY6PgIGSk5SVlpeYmZqbnJ2en5CRoqOkpaanqKmqq6ytrq+gobKztLW2t7i5uru8vb6/sLHCw8TFxsfIycrLzM3Oz8DB0tPU1dbX2Nna29zd3t/Q0eLj5OXm5+jp6uvs7e7v4OHy8/T19vf4+fr7/P3+//DzCgwIEECxo8iDChwoUMGzp8CDGixIkUK1q8iDGjxo0cO3r8CDKkyJEkS5o8iTKlypUsW7p8CTOmzJk0a9q8iTOnzp08e/r8CTSo0KFEixo9ijSp0qVMmzp9CjWq1KlUq1q9ijWr1q1cu3r9Cjas2BABypo9izat2rVs27p9Czeu3Ll069q9C3es3r18+/r9Cziw4MGECxs+jDix4sWMGzt+DDmy5MmUK1u+jDmz5s2cO3v+DDq06NGkS5s+jTq16tWn7LL+EqBC7NddZk+wTVsL7gi7c1/p/QC4byrCGxQfHuX4AuXInTBP8Lz5kugHqEtHYh1A9utFsm/nPsQ7eOKyx08Rbz55+fRQ0LPHnlZ2/PdCvjuwT/8FfgX787vobwCA/rXQn4ADEpiBgQciaIGCCzJ424NJUOeghP/xZuF0wWXIRHEVcggDcB+CGCJ0JD5h24gnxhCbiiuy+GKMMs5IY4023ohjjjruyGOPPv4IZJBCDklkkUYeiWSSSi7JZJNOPglllFJOSWWVVl6JZZZabslll15+CWaYYo5JZplmnolmmmquyWabbr4JZ5xyzklnnXbeiWeeeu7JZ59+/glooIIOSmihhh6KaKKKLspoo44+Cmmkkk5KaaWWXopppppuymmnnn4Kaqiijkpqqaaeimqqqq7KaquuvgprrLLOSmuttt6Ka6667sprr77+Cmywwg5LbLHGHutPAQ=="
script:"div.0"
{widgets}
button1:{"type":"button","size":[60,20],"pos":[442,312],"script":"Index.1","text":"Next","style":"rect"}
button2:{"type":"button","size":[60,20],"pos":[10,312],"script":"Index.1","text":"Prev","style":"rect"}
title:{"type":"field","size":[492,17],"pos":[10,22],"locked":1,"font":"menu","show":"invert","border":1,"align":"center","value":"bn.div[], bn.mod[], bn.divmod[]"}
button3:{"type":"button","size":[60,20],"pos":[78,312],"script":"Index.1","text":"Index","style":"rect"}
field1:{"type":"field","size":[248,238],"pos":[254,48],"locked":1,"border":0,"value":{"text":["The \"bn\" module also provides division, calculating either the quotient (div), remainder (mod), or both as a two-element list (divmod).\n","\nbn.div[x y]\nbn.mod[x y]\nbn.divmod[x y]","\n\nLike all arithmetic operations provided by \"bn\", these functions will automatically coerce their arguments as if with bn.make[]; thus they can be called with any combination of bignums, numbers, or digit-strings.\n\nIf attempting to divide by 0, the result will be the Lil number \"0\", consistent with undefined arithmetic results for Lil operators, and compatible with the \"unless\" operator for coercing error values."],"font":["","mono",""],"arg":["","",""]}}
dividend:{"type":"field","size":[232,21],"pos":[10,93],"script":"formatting.1","border":1,"style":"code","value":"80087"}
quotient:{"type":"field","size":[111,17],"pos":[10,211],"locked":1,"volatile":1,"border":1,"style":"code"}
divisor:{"type":"field","size":[232,21],"pos":[10,127],"script":"formatting.1","border":1,"style":"code","value":"221"}
remainder:{"type":"field","size":[114,17],"pos":[128,211],"locked":1,"volatile":1,"border":1,"style":"code"}
field3:{"type":"field","size":[110,13],"pos":[11,198],"locked":1,"show":"transparent","border":0,"style":"plain","value":"quotient"}
field4:{"type":"field","size":[114,13],"pos":[128,198],"locked":1,"show":"transparent","border":0,"style":"plain","value":"remainder"}

{script:div.0}
on view do
 r:bn.divmod[dividend.text divisor.text]
 quotient.text:first r
 remainder.text:last r
end
{end}

{card:reduce}
{widgets}
button1:{"type":"button","size":[60,20],"pos":[442,312],"script":"Index.1","text":"Index","style":"rect"}
button2:{"type":"button","size":[60,20],"pos":[10,312],"script":"Index.1","text":"Prev","style":"rect"}
title:{"type":"field","size":[492,17],"pos":[10,22],"locked":1,"font":"menu","show":"invert","border":1,"align":"center","value":"reduction"}
field1:{"type":"field","size":[248,238],"pos":[254,48],"locked":1,"border":0,"value":{"text":["As an additional convenience, the \"bn\" module provides \"reducer\" functions which are equivalent to the Lil primitives sum, prod, min, and max, accumulating a list of bignums into a single bignum result:\n\n","bn.sumall[x]\nbn.prodall[x]\nbn.minall[x]\nbn.maxall[x]","\n\nIf the input list is empty, bn.prodall[] will return the bignum \"1\", consistent with the Lil primitive. All other functions will return the bignum \"0\"."],"font":["","mono",""],"arg":["","",""]}}
ex1:{"type":"field","size":[232,73],"pos":[10,48],"border":1,"style":"code","value":"result.text:bn.format_commas[\n bn.sumall[\"\\n\" split input.text]\n]"}
button4:{"type":"button","size":[60,20],"pos":[254,266],"script":"logic.0","text":"Try It!"}
result:{"type":"field","size":[232,32],"pos":[10,254],"locked":1,"volatile":1,"border":1,"style":"code"}
field2:{"type":"field","size":[232,13],"pos":[10,240],"locked":1,"show":"transparent","border":0,"style":"plain","value":"result"}
input:{"type":"field","size":[232,82],"pos":[10,147],"border":1,"scrollbar":1,"style":"code","value":"1\n20\n3000\n400000\n500000000\n600000000000"}
field4:{"type":"field","size":[232,13],"pos":[10,133],"locked":1,"show":"transparent","border":0,"style":"plain","value":"input"}

{module:bn}
description:"arbitrary-precision arithmetic for natural numbers."
version:1.1
{script}
digits:"" split "0123456789"
names:"%j" parse "[
 'million','billion','trillion','quadrillion','quintillion','sextillion','septillion','octillion',
 'nonillion','decillion','undecillion','duodecillion','tredecillion','quattuordecillion','quindecillion',
 'sexdecillion','septendecillion','octodecillion','novemdecillion','vigintillion','unvigintillion',
 'duovigintillion','tresvigintillion','quattuorvigintillion','quinvigintillion','sesvigintillion',
 'septemvigintillion','octovigintillion','novemvigintillion','trigintillion','untrigintillion',
 'duotrigintillion','trestrigintillion','quattuortrigintillion','quintrigintillion','sestrigintillion',
 'septentrigintillion','octotrigintillion','noventrigintillion','quadragintillion'
]"

on make x do
 if "list"~typeof x x else
  x:0+"" split digits take "" fuse x # ignore _ and , place-separators
  while (count x)&0~first x x:1 drop x end x # always normalize
 end
end
on norm x do
 x:make[x]
 while (count x)&0~first x x:1 drop x end x
end

on align f do
 on _ x y do
  x:norm[x] cx:count x
  y:norm[y] cy:count y
  if cy<cx y:((cx-cy)take 0),y end
  if cy>cx x:((cy-cx)take 0),x end
  f[x y]
 end
end
local more:align[on _ x y do 0<first norm[x-y] end]
local less:align[on _ x y do 0>first norm[x-y] end]
local add:align[on _ x y do
 local a:0,x+y
 while sum c:a>9 a:(10%a)+(1 drop c,0) end norm[a]
end]
local sub:align[on _ x y do
 if 0>first norm[x-y] 0 else # return "0" on underflow
  local a:x-y
  while sum c:a<0 a:(10%a)-(1 drop c,0) end norm[a]
 end
end]

on mul x y do
 x:norm[x] y:norm[y]
 norm[sumall[each digit i in y
  sumall[digit take list x],((-1+count y)-i)take 0
 end]]
end

on divmod x y do
 x:norm[x] y:norm[y] local r:()
 if !count y 0 else # return "0" on divide by zero
  while !less[x y]
   local a:() local i:0 local b:y local c:0 local digit:0
   while (i<count x)&!more[a y] i:i+1 a:i take x end
   while !more[b a] c:b digit:digit+1 b:add[b y] end
   local z:((count x)-i)take 0
   r:add[r digit,z]
   x:sub[x     c,z]
  end
  (list r),(list x)
 end
end

on format_plain x do
 x:norm[x]
 "" fuse if ()~x 0 else x end
end
on format_commas x do
 "" fuse each digit i in x:"" split format_plain[x]
  local p:(-1+count x)-i
  if p&!3%p digit,"," else digit end
 end
end
on format_name x do
 x:"" split format_plain[x]
 if 7>count x "" fuse x else
  local p:floor (-7+count x)/3
  if !p<count names "many" else
   local sig:(count x)-(3*2+p)
   local num:(0+"" fuse (3|sig) limit x)/10^3-sig
   "%f %s" format num,names[p]
  end
 end
end

module:raze insert k v with
 "make"          make
 "equal"         on equal x y do norm[x]~norm[y] end
 "more"          more
 "less"          less
 "add"           add
 "sub"           sub
 "mul"           mul
 "divmod"        divmod
 "div"           on div x y do first divmod[x y] end
 "mod"           on mod x y do last  divmod[x y] end
 "sumall"        on sumall  x do r:make[first x] each v in 1 drop x r:add[r v] end r end
 "prodall"       on prodall x do if !count x make[1] else r:make[first x] each v in 1 drop x r:mul[r v] end r end end
 "minall"        on minall  x do r:make[first x] each v in 1 drop x r:if less[v r] v else r end end r end
 "maxall"        on maxall  x do r:make[first x] each v in 1 drop x r:if more[v r] v else r end end r end
 "format_plain"  format_plain
 "format_commas" format_commas
 "format_name"   format_name
end
{end}

