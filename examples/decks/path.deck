{deck}
version:1
card:0
size:[512,342]
name:"path module"
patterns:"%%IMG3AAgA5ggAAQgcSLCgwYMIEypMGKChw4cQI0qcSLFixYMBMGKUSDCjQY8FQU4UCHJgSZIbQ6JcSbLhx5cmFyI8CVOmSoUjHQKw6FInxZ09eQLNSNTlSpEdh4r0adIo0qE7W+pkWZJozZkvjUalGpMrS5xdNX5lGHZjUZ89oUJUq/YhW7Rwo9KkaZPu1qtiweKFGtbjSa0h7Vodi/Rp37t/YxrmanVwY6Bytz5O6zgyZcmW7SYdexPrXc9fAX/02xSyVr+aIbdUqtryZ5WPscbWOHt0RNc/J+fMzFE3R7NrgbsVPjUr7uOTkStPnhyx182Yj3Zd7LXwWdNB27pF27Y73Livw4Muy3ku3rPfL95ev5b99uGcYUeWmdq5XqVLg6JfLfU0fO1PXaYZdfNVFxh5WVXVmlwK3kabe+8R9M+EExLEjUD/AHCJDRoKpIyGGaIiUBkAlMHhJSbmoqIhLBbh4kABAQ=="

{card:Index}
image:"%%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"
script:"Index.0"
{widgets}
field1:{"type":"field","size":[154,17],"pos":[342,136],"locked":1,"font":"menu","border":0,"align":"center","value":"Pathfinding for Decker"}
button1:{"type":"button","size":[60,20],"pos":[442,316],"script":"Index.1","text":"Next","style":"rect"}
field2:{"type":"field","size":[248,55],"pos":[14,142],"locked":1,"show":"transparent","border":0,"value":{"text":["The \"path\" module provides flexible grid-based pathfinding routines.\n\n\n","Index:"],"font":["","menu"],"arg":["",""]}}
index:{"type":"field","size":[243,117],"pos":[16,197],"locked":1,"volatile":1,"script":"Index.2","scrollbar":1}
version:{"type":"field","size":[42,14],"pos":[16,318],"locked":1,"volatile":1,"border":0}

{script:Index.0}
on view do
 bullet:image["%%IMG0AAYADQAAAAB49Pz8/HgAAAA="]
 i:select c:key t:value..widgets.title.text where value..widgets.title from deck.cards
 index.value:raze each row in rows i
  rtext.make["" "" bullet],
  rtext.make["  "],
  rtext.make[("%s\n" format row.t) "mono" row.c]
 end
 version.text:"v%0.1f" format deck.modules.path.version
end
{end}

{script:Index.1}
on click do
 t.Prev:"SlideRight"
 t.Next:"SlideLeft"
 t.Index:"BoxOut"
 go[me.text t[me.text] 15]
end
{end}

{script:Index.2}
on link val do
 go[val "BoxIn" 15]
end
{end}

{card:overview}
image:"%%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"
script:"overview.0"
{widgets}
button1:{"type":"button","size":[60,20],"pos":[442,316],"script":"Index.1","text":"Next","style":"rect"}
button2:{"type":"button","size":[60,20],"pos":[10,316],"script":"Index.1","text":"Prev","style":"rect"}
title:{"type":"field","size":[492,17],"pos":[10,19],"locked":1,"font":"menu","show":"invert","border":1,"align":"center","value":"Overview"}
field2:{"type":"field","size":[236,269],"pos":[266,41],"locked":1,"border":0,"value":{"text":["The \"path\" module performs pathfinding. Given a grid, it computes a list of moves which define a route from a start point to an end point, avoiding impassable cells.\n\nThe module exposes several functions which operate on pixel-based coordinates, automatically discretized to some grid cell size:\n\n","- path.find[start goal grid etc]\n- path.test[pos grid etc]\n- path.closest[pos t grid etc]","\n\nAs well as equivalents which operate on grid-cell based coordinates, otherwise taking the same arguments:\n\n","- path.find_cell[start goal grid etc]\n- path.test_cell[pos grid etc]\n- path.closest_cell[pos t grid etc]","\n\nFinally, this deck includes a contraption called the ","Follower ","which can automatically interpolate along a supplied path with configurable animation."],"font":["","mono","","mono","","menu",""],"arg":["","","","","","",""]}}
button5:{"type":"button","size":[60,20],"pos":[78,316],"script":"Index.1","text":"Index","style":"rect"}
field5:{"type":"field","size":[74,14],"pos":[61,72],"locked":1,"border":0,"style":"plain","align":"center","value":"grid cell"}
field1:{"type":"field","size":[117,14],"pos":[103,263],"locked":1,"border":0,"style":"plain","align":"center","value":"impassable cells"}
field3:{"type":"field","size":[27,14],"pos":[23,160],"locked":1,"border":0,"style":"plain","align":"center","value":"grid"}

{script:overview.0}
on view do
 
end
{end}

{card:find}
{widgets}
button1:{"type":"button","size":[60,20],"pos":[442,316],"script":"Index.1","text":"Next","style":"rect"}
button2:{"type":"button","size":[60,20],"pos":[10,316],"script":"Index.1","text":"Prev","style":"rect"}
title:{"type":"field","size":[492,17],"pos":[10,19],"locked":1,"font":"menu","show":"invert","border":1,"align":"center","value":"path.find[]"}
field2:{"type":"field","size":[236,269],"pos":[266,41],"locked":1,"border":0,"value":{"text":["In its simplest form, path.find[] computes a route from a start point to an end point along a grid.\n\n","path.find[start goal grid etc]","\n\n- START: a pair of coordinates or a widget.\n- GOAL: a pair of coordinates or a widget.\n- GRID: an Image, Canvas, or Card.\n- ETC: a dictionary of optional parameters.\n\nBy default, the grid uses 16x16 pixel cells, and cells within the grid which contain any black pixels (pattern 1) are considered impassable.\n\nIn this case, the start and goal are specified in pixels relative to the top-left corner of the grid, and the result is a list of coordinate pairs of grid centerpoints in the same coordinate system.\n\nIf path.find[] is unable to find a passable route, it will return 0."],"font":["","mono",""],"arg":["","",""]}}
button5:{"type":"button","size":[60,20],"pos":[78,316],"script":"Index.1","text":"Index","style":"rect"}
viewer:{"type":"contraption","size":[250,120],"pos":[10,190],"def":"scriptViewer","widgets":{"o":{"size":[100,24],"pos":[273,1],"value":"grid"},"c":{"size":[250,18]},"i":{"size":[100,30],"pos":[273,38],"interval":[0,0]},"scr":{"size":[246,99]}}}
grid:{"type":"canvas","size":[128,128],"pos":[46,54],"locked":1,"script":"find.0","pattern":35,"image":"%%IMG3AIAAgAbAhnBILDYAyKRyCTA6h8xo8vmUSqlOaxRr1DK5Re8STBQryVAzEi1Ur9nuJtzNPtLn6npcf0fv8WZ8eYBigoFGI4ldfWR/foxgjkOJlGGQXJKRl1iZlJ5lm1SZmKFVkJ6fbaVZq4uDj69CqKmjnK2WsZq5DbOVtaK3oLu2w72Jv6bDwMrJh4jGwWnMrNOuzs+91bjXutyk08Yj3sTjy+XNhVjh6bDn1O7WcVLh3/Db7I3Rql705vjd/+oFJKel37uB/rwYQoiuoLGGWhYqJDSxnRiDwuxlZHiwYr48GPdplDZSJMd4E0Mi6xiRYkuLFTGuRPnyY0k7sR6SPHnPI0CfAn322giUYNGENX8mHbrzKEQrEpMGXTqLqFSjV5FCdbl1UtWmWZ9e4ToWJlVUVrva5Jm27FqhX006ZalWad2pdZnKDUvXrV2/dQRmSxKgsOHDiAPM7MmX5l2Cg5EoNjNZW9stZDFbjAxAceLEnRdf/pKZ9OZZSjx/PhxaH86bondyVr26cGvLYB9rBQwZNeHOtW1Xhu06tsnZwIPfJo57r250yIMLN/6abW7e/qJLX27dOXaxmtdqVz68e/W5jr8fHF+bO3rGz/uGB8h+tfvG8NWnny/Yt+Tk7ZX33mhjlFbgaaikBqB9AuJH4BkGQoigJwpK5xl1GBanRH2f3Rfffqa9JU9ecTVAW4BRfZgff1iRiNYQJzKYon4rhvjXfHqZuGCHAczI4m4/gmdjjjHy6KONeNH44BREELkjaD1GyKRZKi75hlcvClEklEceKGKV1+FY4paIddalhF8qGeaQYz5ZZpRUquldkPKxGReZrMGZJp0genmjnV/haZiZUl65J5ItAkaPoMKdOeWhfibJYjiMeuaooX9GmuiP61hIaJx81qgpkIjKYoynemaKpqqPsoppEet4kaqkpQo5qq2rYjOLhZfKAWqtgfUZUp+5YmHhYb2eOayVvpLRYBSzbgossQAsO+e0RVT6KaTFkrqhTtS+aqybeSZbaLXgMluHttF62y2uUwxLHbvm/lqgSq7Re269MuVL7qDtwiuuu48aNO+/je6rMJZfHYxqvdy2ystDDm8XcJ23YlxsrM3p+PDCEQ/MsXn62vuuxhIznOBNJYfcrKsvwwoNyQhbCjLMXIwsp8cW95qhQzk6cWyeFv/MHNAlGvGsFagabZ4a1vI8dNMaduyGtZVOfWHVR1+ULow1a+3hzk4rNGzWU48dqroKh4T20Gpjy7bJU2L09rFxZxxuzNJ6adDdVFvN9T/9AF704AOuGemiYae99NqKn7y3E5Q2DvfjckeeMsEiQ6N14F0nfu2tlH5OXtkOaj6wqZyNyATmeosqueybq+yJ6cq5BnGmUY8++9wuK/s17aujXPzkUkaNOpi+1268tcuTjTjSWQKP8820jiHv9Myfl3rzb+Ar+Pihv9Qv+U9z71a60UMOPt+cv5xj+5m/v/vElVif/e+qwy8w3/nTX9/4Zz/sDdB5yKPb8YjnP+M1MIHBM2D87nfABQpwgueiX+wu+D8KYlCBD2SgBzsoQRKCcIQORCEEr3fCEqbQhSvcHwJFCEMatvCGEcQhC3PIwx36UIYW7J8KbdhDIIaQgy/UoRGHiMQYVvCIQqxhE4n4wycyMYpKtKIUsVhELaIhCA==","brush":4,"scale":1}
ref:{"type":"canvas","size":[32,32],"pos":[188,97],"locked":1,"image":"%%IMG3AIAAgASwyUlrAzjrDayfXJh9nyiSnhmilsqxlbvBlKzRoI3hkr7zvg7Qx7sQh7piUHnELZE2ZhIqk0apLmsVq9JmuSZvF3wir8wv9Ex9Y4/cP2eT9pRP7Vf8Vv/lj/1hcEKAZYRnhmmIa4ptjG+OcXRzMHWSd5Z5mHuafZx/noGQg6CFpIemiaiLqo2sQY+ukZSTLJWzl7eZuZu7nb2fv6Gxo8GlxafHqcmry63NsM+ytbQottO417rZvNu+3cDfwtHE4cblyOfK6czrzu3Q79LV1CTW89j32vnc+9794P/ExSMX0FxBdAfVJWS30F1DeA/l1aNXgmIKiy0wxtBYg2MOfBNBVhR5kWRGkxtRdlT5UV+RkDYCyJxJs2YAezD55fS3U8XNmDhHuhSqk6iLmzZtAvjJsodHp02N6ECalObSoCWHZi269ejSqjOvPpWq9WTZlEDBhmV6dmXbllzNyqCqVmxUrHJ5GvX5tS7buGgBuxUM16tamXbfQlVMlvDiuX3BJnbcWG9XgD1N0JX813JezHsFRrx6GCnewJ5Rg76sOXLVyakHxy68+nPr0rBrqxad2WDvEJtfd9Ytmzht3qFFBE+aGzlr38lfKSSxXGkAMc5tQ3+OkLpr5tcFYd+uvfuH6jWXjjfPfXp09x7QWw0vaj388vcryF9rn+Hv/MVlp9931vXn0H/+vZdgfASmR98wBkKE4IHnNThfhBIpSGF7C1qwH2IPjoMhQRNKWCFuIQ404oo8fIgUi/WJ16KF/MkY4400uKiejRDyCIOOKY4GY484DAfckCL6yEJpNCGp4ks4JlkkkzI5KaSSKBjJQZAlZsjhhvh1OCCKVnZJooYmMkgmlmaWeeJhO0b5pJxZ0giim1+mGSaYY8LJJZpe7qnnbuT16ReeggZKKHse2vkim4CemaeiFACJ6KIAHldopY7GSeSnUubY6Z+TSpqoqZiKyemadLYJqZp+Xhrgppoyaihnstaa6WOzSWCpIKfNamulVILoZ7C6qposn5wGgSKyvBoXrYCrFvvsWNBWJm0DLlrbHK3TgqsttRN0W+y3wy47qLC7cuuot1qmG66844prLpXotptttvcyma+y8+o7Vr/X3oXtwO+eG6/ABkdF8LEHN8zYw37tG/HECeO7MMD10stvxv5uzKy6lJKMarPS8XUxZfxae+5YuQbMscUSs7xyrx0zzBjNO9+8Lc8214wz0EP7TK7MIyO9rskx5zyz0eIS/TPUHlOtc9A9Cz211kc7nbTXSytdstgnM/3qqU1L3bXaUVv9NNdtw1213FcXTffbKW+d9d5Y920333/7rbfga7v9NdtzAz544Iwv7njhdx9ueNhgj1152WSnPbnliNf9eNyKQx466IST3rjopSeeuueon27656q7HjvsrL/eOu14r85xBA==","scale":0.25}
field5:{"type":"field","size":[74,14],"pos":[71,38],"locked":1,"border":0,"style":"plain","align":"center","value":"grid"}
field1:{"type":"field","size":[43,14],"pos":[182,83],"locked":1,"border":0,"style":"plain","align":"center","value":"ref"}

{script:find.0}
on click pos do
 g:ref.copy[]
 p:path.find[0,0 pos g]
 grid.pattern:colors.red
 grid.brush:4
 grid.paste[g]
 grid.line[p]
end
{end}

{card:coordinates}
image:"%%IMG3AgABVgKEj6nL7Q+jnLTai7PevPsPhuJIluaJpurKtu4Lx/JM1/aN5/rO9/4PDAqHxKLxiEwql8ym8wmNSqfUqvWKzWq33K73Cw6Lx+Sy+YxOq9fstvsNj8vn9Lr9js/r9/y+/w8YKDhIWGh4iJiouMjY6PgIGSk5SVlpeYmZqbnJ2en5CRoqOkpaanqKmqq6ytrq+gobKztLW2t7i5uru8vb6/sLHCw8TFxsfIycrLzM3Oz8DB0tPU1dbX2Nna29zd3t/Q0eLj5OXm5+jp6uvs7e7v4OHy8/T19vf4+fr7/P3+//DzCgwIEECxo8iDChwoUMGzp8CDGixIkUK1q8iDGjxo0cO3r8CDKkyJEkS5o8iTKlypUsW7p8CTOmzJk0a9q8iTOnzp08e/r8CTSo0KFEixo9ijSp0qVMmzp9CjWq1KlUq1q9ijWr1q1cu3r9Cjas2LFky5o9izat2rVs27p9Czeu3Ll069q9izev3r18+/r9Cziw4MGECxs+jDix4sXwAvhxfBgyH8mFKeuxPBgzHs2BOdvx/Bc0HdF9ScsxvRc1HNV5WbtxfRc2G9l1aauxPRc3Gt1xeZvx/RY4GeFtiYsxvhY5GOVpmXtxfhY6F+llqWuxPhY7Fu1fA3j3fvk7d67ix0cpTxh9HvWZwe/5bhj+e/fp6a+3n/kxYvNU+DP+D2CAAg5IYIEGHohgggouyGCDDj4IYYQSTkhhhRZeiGGGGm7IYYcefghiiCKOSGKJJp6IYooqrshiiy6+CGOMMs5IY4023ohjjjruyGOPPv4IZJBCDklkkUYeiWSSSi7JZJNOPglllFJOSWWVVl6JZZZabslll15+CWaYYo5JZplmnolmmmquyWabbr4JZ5xyzklnnXbeiWeeeu7JZ59+/glooIIOSmihhh6KaKKKLspoo44+Cmmkkk5KaaWWXopppppuymmnnn4Kaqiijkpqqaaeimqqqq7KqoUFAA=="
{widgets}
button1:{"type":"button","size":[60,20],"pos":[442,316],"script":"Index.1","text":"Next","style":"rect"}
button2:{"type":"button","size":[60,20],"pos":[10,316],"script":"Index.1","text":"Prev","style":"rect"}
title:{"type":"field","size":[492,17],"pos":[10,19],"locked":1,"font":"menu","show":"invert","border":1,"align":"center","value":"path.find[]: coordinates"}
field2:{"type":"field","size":[236,269],"pos":[266,41],"locked":1,"border":0,"value":"The START and GOAL arguments to path.find[] can be specified as pairs or references to widgets. The GRID argument can be given as an image, a card, or a canvas. \n\nIf START or GOAL are given as pairs, they will be interpreted as positions in pixels relative to the origin of the GRID.\n\nIf START or GOAL are given as a widget reference, the centerpoint of that widget is converted to a position in pixels relative to the position of the GRID: (0,0) for a card or image or the .pos attribute of a canvas.\n\nSTART and GOAL don't need to be of the same type.\n\nThe resulting route will always be given in a coordinate system which matches the START. Thus, if you provide START as a pair, you'll get back route coordinates which can be directly used to draw on a canvas, whereas if you provide START as a widget you'll get back path coordinates which can be used as the centerpoint for positioning widgets on the card."}
button5:{"type":"button","size":[60,20],"pos":[78,316],"script":"Index.1","text":"Index","style":"rect"}
field5:{"type":"field","size":[107,14],"pos":[19,135],"locked":1,"border":0,"style":"plain","align":"center","value":"position on canvas"}
field1:{"type":"field","size":[107,14],"pos":[19,180],"locked":1,"border":0,"style":"plain","align":"center","value":"positions on canvas"}
field3:{"type":"field","size":[107,14],"pos":[141,135],"locked":1,"border":0,"style":"plain","align":"center","value":"widget on card"}
field4:{"type":"field","size":[107,14],"pos":[141,180],"locked":1,"border":0,"style":"plain","align":"center","value":"widget centers on card"}

{card:etcparams}
image:"%%IMG3AgABVgQQyEmrvTjrzbv/YCiOZGmeaKqubOu+cCzPdG3feK7vfO//wKBwSCwaj8ikcslsOp/QqHRKrVqv2Kx2y+16v+CweEwum8/otHrNbrvf8Lh8Tq/b7/i8fs/v+/+AgYKDhIWGh4iJiouMjY6PkJGSk5SVlpeYmZqbnJ2en6ChoqOkpaanqKmqq6ytrq+wsbKztLW2t7i5uru8vb6/wMHCw8TFxsfIycrLzM3Oz9DR0tPU1dbX2Nna29zd3t/g4eLj5OXm5+jp6uvs7e7v8PHy8/T19vf4+fr7/P3+/wADChxIsKDBgwgTKlzIsKHDhxAjSpxIsaLFixgzatzIsaPHjyBDihxJsqTJkyhTqlzJsqXLlzBjypxJs6bNmzhz6tzJs6fPn0CDCh1KtKjRo0iTKl3KtKnTp1CjSp1KtarVq1izat3KtavXr2DDih1LtqzZs2jTql3Ltq3bt3Djyp1Lt67du3jz6t3Lt6/fv4ADCx5MuLDhw4gTK17MuLHjx5AjS55MubLly5gza97MubPnz6BDix5NurTp06hTq17NurXr17Bjy55Nu7bt27hz697Nu7fv38CDCx9OvLjx48iTK1/OvLnz59CjS59Ovbr169iza9/Ovbv37+DDix9Pvrz58+jTH2nAvr379/Djy59Pv779+/jz69/Pv3/+oQ1sE6BQA2ZTIFAHXpOgTwtW0yBPD04ToU4TRlMhThc+k6FNGzbTIU0fLhOiTCMmUyJMJx6ToksrFtMiSy8OE6NKMwZTI0o3/pKjSTv20iNJP+4SpEhD5lIkSEfekqRHS9bSJEdPzhKlRlPGUiVGV76SpUVbttIlRV+uEqZEY6ZSJkRnnpKmQ2uW0iZDb44Sp0JzhlInQnd+kqdBe3bSJ0F/bhKoQINmUihAh16SqD+LVtIoP49OEqk+k0ZSKT6XPpKpPZs20ik9ny4SqjyjJlIqPKcekqo7qxbSKjuvDhKrOrMGUis6t/6Rqzm79tErOb/uEaw4w+ZRLDjH3pGsN8vW0Sw3z84RrTbTxlEtNte+ka0127bRLTXfrhGuNOOmUS40556RrjPrltEuM++OEa8y84ZRLzL3fpGvMft20S8x/24RsDADZ1EwMAdfkbAvC1fRMC8PTxGxLhNHUTEuFz+RsS0bN9ExLR8vEbIs/pVs8skop6zyyvup5/LLMMcs88w012zzzTjnrPPOPPfs889ABy300EQXbfTRSCet9NJMN+3001BHLfXUVFdt9dVYZ6311lx3XV0E"
{widgets}
button1:{"type":"button","size":[60,20],"pos":[442,316],"script":"Index.1","text":"Next","style":"rect"}
button2:{"type":"button","size":[60,20],"pos":[10,316],"script":"Index.1","text":"Prev","style":"rect"}
title:{"type":"field","size":[492,17],"pos":[10,19],"locked":1,"font":"menu","show":"invert","border":1,"align":"center","value":"path.find[]: etc"}
field2:{"type":"field","size":[236,269],"pos":[266,41],"locked":1,"border":0,"value":"The fourth \"etc\" parameter to path.find[] (as well as other functions in the path module) is a dictionary which accepts a variety of optional keys:\n\n- etc.cell: a pair giving the width and height of grid cells in pixels. defaults to (16,16).\n\n- etc.block: a list of impassable patterns. If any pixels within a cell contain an impassable pattern, the entire cell is considered impassable. defaults to (list 1).\n\n- etc.shuffle: if truthy, produce random results of equal cost when several are available, instead of a consistent arbitrary result.\n\n- etc.move: a list of relative offsets (in grid cells) to consider for each step on a route. may also be specified as one of the strings:\n\n\"ortho\" (orthogonal movement)\n\"diag\" (diagonal movement)\n\"orthodiag\" (ortho and diag, the default)."}
button5:{"type":"button","size":[60,20],"pos":[78,316],"script":"Index.1","text":"Index","style":"rect"}
grid:{"type":"canvas","size":[128,128],"pos":[49,70],"locked":1,"script":"etcparams.0","pattern":35,"image":"%%IMG3AIAAgAbAhnBILDYAyKRyCTA6h8xo8vmUSqlOaxRr1DK5Re8STBQryVAzEi1Ur9nuJtzNPtLn6npcf0fv8WZ8eYBigoFGI4mKi4yLX4RehoWQWoiNl5djlFaSkZtXRJiijWefW6aPfn1Co62JpaqDsYezk0OurbBkf7WevZVFuKK6YLy7q8XIrMKkU6iav5zPxFxLmc7RoNmn26nHSddv3dDftOW25+Fy49RYxsmy6c3i5771wOxx2MuMZcru/6i8q4bskr948MwlRLfQXgODaRASlAiQosCCjQ4qnLixYseLCCG2CViFZBaTXTAyW7kopcWSL0+GZEkzURiUN2O6VFizp0aGHIF6ZNiz5k+HQZEOdViU5lF896Tlo8evKa6nUqNq08otlNWrET/CFCuT7E6iGcMKBWk2Z1usWx+mHanT7dqxd8ui7adWKdu8Z/3iZTrXTl24Xes01BKgsePHkANYm7eOq7fFWTFLkWyGMzjKnaBqTpyUMYDIkU9PZtTur2C9rwObRg1ZtRJ1oTOX1r10Nm3Htj+z3jf68u64x6NI/g3cMxLc04gnN97bynLmy1c7kl4deXfS35lcZx78OejoVKeTK75k/O/yAKBPrcy+9WDf5J3HPz8/t3fX+L2nn3yWraeefbAFSBt8BNbHHYC8QbjZadgxyF+BCMoW4X3WUZifdopkaFdsI4p2YBLuLTjghQ6mF56BLyqRImoWDueihODhqA+MVMyYWgDBFDZQjA9y+N8TPtYGpFd80fVWXyYSeSOSHgoYZJOGPekkYCVu6ESSj512ZUtQeqnhkQmaWQSYzY2pCGLU6cijkTlSid1ybtpUJppn1pkmn2tWqWKeI8A5559+9hmnnRUueYuQOBkqoqRFfikojY5W9eaeiXYJKKVTWnqnmEySuSWJoNJ3YqhGsNkYqY9iOaSck3K6qKiNEpqqf53uyoareJa66alR0lqpooe2eumPutqarKe9OlurEPpZ1yyxavra3693OnZtllxqq1iLqg7VIBfdeoteucayate5WFS7Ga+3IjstuPD2uKyS9D4r7kL5Mppfv/fOilfAuA68LsHHvssiuvuGmSm5DLv7E8LKjjrxquzSWa/DNnacsJULl1wLxoFqXLHI9jZ88cPxRtymyRi6rBbKRAALa80WS2vzljgPofPGUrIM7ccvh1zH0Cs3TUjQ1Mr8KtHtGv1vUFA3wDTNFD8Ns74qr2swopeJpHW6Uzc6dss9YxuX2fIypnakPrcNLmFYAot2dnS7Ha3fZRemN9rwoVq31Yd/O3i6hRfrsb+JC6tn1HtrvPbRkAO+HtxSV954tpFvG6upWne+9+efhs4zfZxXPvdhqnc9+rClu/5h33c7TvbmgptOeNypa16wSqQv3i3qf+cOuvDEtW67ipdfXbTivjMOfPLRx875jl5cj3TsHCv+fIW4O33y148PDzvzdoP4ys/KBx8/9ri7P4L6Ws7/PfuIA43+7vgLF/jM9T+29U9/mUNgAItiQPOtThJNwVwADcc/CEZwgFVzIMAuWEGuhc9rDMRg+uCXvVOFUIQAJGH9mGAUCapwfQp8Yf5KGMP2rRCGNMzhDWe4QwF2UHQPFFsPKVjDA+oQh0PUXQM9OD0mZtCJI7QhEqfIQyr6sIga/CAQZRfELWqxi2Dkohi/OMYmetGMYSSjGtFYxiee0Y1pZOMa4djGKBoxicvDIhRTKMUq+vGKR/wjEQMJSNwFAQ==","brush":4,"scale":1}
ref:{"type":"canvas","size":[32,32],"pos":[191,113],"locked":1,"image":"%%IMG3AIAAgASwyUlrAzjrDayfXJh9nyiSnhmilsqxlbvBlKzRoI3hkr7zvg7Qx7sQh7piUHnELZE2ZhIqk0apLmsVq9JmuSZvF3wir8wv9Ex9Y4/cP2eT9pRP7Vf8Vv/lj/1hcEKAZYRnhmmIa4ptjG+OcXRzMHWSd5Z5mHuafZx/noGQg6CFpIemiaiLqo2sQY+ukZSTLJWzl7eZuZu7nb2fv6Gxo8GlxafHqcmry63NsM+ytbQottO417rZvNu+3cDfwtHE4cblyOfK6czrzu3Q79LV1CTW89j32vnc+9794P/ExSMX0FxBdAfVJWS30F1DeA/l1aNXgmIKiy0wxtBYg2MOfBNBVhR5kWRGkxtRdlT5UV+RkDYCyJxJs2YAezD55fS3U8XNmDhHuhSqk6iLmzZtAvjJsodHp02N6ECalObSoCWHZi269ejSqjOvPpWq9WTZlEDBhmV6dmXbllzNyqCqVmxUrHJ5GvX5tS7buGgBuxUM16tamXbfQlVMlvDiuX3BJnbcWG9XgD1N0JX813JezHsFRrx6GCnewJ5Rg76sOXLVyakHxy68+nPr0rBrqxad2WDvEJtfd9Ytmzht3qFFBE+aGzlr38lfKSSxXGkAMc5tQ3+OkLpr5tcFYd+uvfuH6jWXjjfPfXp09x7QWw0vaj388vcryF9rn+Hv/MVlp9931vXn0H/+vZdgfASmR98wBkKE4IHnNThfhBIpSGF7C1qwH2IPjoMhQRNKWCFuIQ404oo8fIgUi/WJ16KF/MkY4400uKiejRDyCIOOKY4GY484DAfckCL6yEJpNCGp4ks4JlkkkzI5KaSSKBjJQZAlZsjhhvh1OCCKVnZJooYmMkgmlmaWeeJhO0b5pJxZ0giim1+mGSaYY8LJJZpe7qnnbuT16ReeggZKKHse2vkim4CemaeiFACJ6KIAHldopY7GSeSnUubY6Z+TSpqoqZiKyemadLYJqZp+Xhrgppoyaihnstaa6WOzSWCpIKfNamulVILoZ7C6qposn5wGgSKyvBoXrYCrFvvsWNBWJm0DLlrbHK3TgqsttRN0W+y3wy47qLC7cuuot1qmG66844prLpXotptttvcyma+y8+o7Vr/X3oXtwO+eG6/ABkdF8LEHN8zYw37tG/HECeO7MMD10stvxv5uzKy6lJKMarPS8XUxZfxae+5YuQbMscUSs7xyrx0zzBjNO9+8Lc8214wz0EP7TK7MIyO9rskx5zyz0eIS/TPUHlOtc9A9Cz211kc7nbTXSytdstgnM/3qqU1L3bXaUVv9NNdtw1213FcXTffbKW+d9d5Y920333/7rbfga7v9NdtzAz544Iwv7njhdx9ueNhgj1152WSnPbnliNf9eNyKQx466IST3rjopSeeuueon27656q7HjvsrL/eOu14r85xBA==","scale":0.25}
field5:{"type":"field","size":[74,14],"pos":[74,54],"locked":1,"border":0,"style":"plain","align":"center","value":"grid"}
field1:{"type":"field","size":[43,14],"pos":[185,99],"locked":1,"border":0,"style":"plain","align":"center","value":"ref"}
shuffle:{"type":"button","size":[75,20],"pos":[48,246],"font":"body","text":"etc.shuffle","style":"check","value":1}
move:{"type":"grid","size":[83,67],"pos":[144,221],"scrollbar":0,"headers":1,"lines":0,"widths":[0],"format":"sJ","value":{"val":["ortho","diag","orthodiag",[[-2,-1],[-1,-2],[1,-2],[2,-1],[-2,1],[-1,2],[1,2],[2,1]]],"etc.move":["ortho","diag","orthodiag","knight"]},"row":0}

{script:etcparams.0}
on click pos do
 g:ref.copy[]
 etc.shuffle:shuffle.value
 etc.move:first move.rowvalue
 p:path.find[0,0 pos g etc]
 grid.pattern:colors.red
 grid.brush:4
 grid.paste[g]
 grid.line[p]
end
{end}

{card:findmulti}
{widgets}
button1:{"type":"button","size":[60,20],"pos":[442,316],"script":"Index.1","text":"Next","style":"rect"}
button2:{"type":"button","size":[60,20],"pos":[10,316],"script":"Index.1","text":"Prev","style":"rect"}
title:{"type":"field","size":[492,17],"pos":[10,19],"locked":1,"font":"menu","show":"invert","border":1,"align":"center","value":"path.find[]: multiple starts"}
field2:{"type":"field","size":[236,269],"pos":[266,41],"locked":1,"border":0,"value":"The path.find[] function may optionally be given a list of widgets or pairs as the START parameter. In this case, it will return a list of routes (or 0) from every provided start point to the GOAL (which may not be \"listy\" in the same manner).\n\nExtracting multiple routes at once in this fashion is much more efficient than performing separate calls to path.find[]; prefer it when possible."}
button5:{"type":"button","size":[60,20],"pos":[78,316],"script":"Index.1","text":"Index","style":"rect"}
viewer:{"type":"contraption","size":[250,120],"pos":[10,190],"def":"scriptViewer","widgets":{"o":{"size":[100,24],"pos":[273,1],"value":"grid"},"c":{"size":[250,18]},"i":{"size":[100,30],"pos":[273,38],"interval":[0,0]},"scr":{"size":[246,99]}}}
grid:{"type":"canvas","size":[128,128],"pos":[46,54],"locked":1,"script":"findmulti.0","pattern":38,"image":"%%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","brush":4,"scale":1}
ref:{"type":"canvas","size":[32,32],"pos":[188,97],"locked":1,"image":"%%IMG3AIAAgASwyUlrAzjrDayfXJh9nyiSnhmilsqxlbvBlKzRoI3hkr7zvg7Qx7sQh7piUHnELZE2ZhIqk0apLmsVq9JmuSZvF3wir8wv9Ex9Y4/cP2eT9pRP7Vf8Vv/lj/1hcEKAZYRnhmmIa4ptjG+OcXRzMHWSd5Z5mHuafZx/noGQg6CFpIemiaiLqo2sQY+ukZSTLJWzl7eZuZu7nb2fv6Gxo8GlxafHqcmry63NsM+ytbQottO417rZvNu+3cDfwtHE4cblyOfK6czrzu3Q79LV1CTW89j32vnc+9794P/ExSMX0FxBdAfVJWS30F1DeA/l1aNXgmIKiy0wxtBYg2MOfBNBVhR5kWRGkxtRdlT5UV+RkDYCyJxJs2YAezD55fS3U8XNmDhHuhSqk6iLmzZtAvjJsodHp02N6ECalObSoCWHZi269ejSqjOvPpWq9WTZlEDBhmV6dmXbllzNyqCqVmxUrHJ5GvX5tS7buGgBuxUM16tamXbfQlVMlvDiuX3BJnbcWG9XgD1N0JX813JezHsFRrx6GCnewJ5Rg76sOXLVyakHxy68+nPr0rBrqxad2WDvEJtfd9Ytmzht3qFFBE+aGzlr38lfKSSxXGkAMc5tQ3+OkLpr5tcFYd+uvfuH6jWXjjfPfXp09x7QWw0vaj388vcryF9rn+Hv/MVlp9931vXn0H/+vZdgfASmR98wBkKE4IHnNThfhBIpSGF7C1qwH2IPjoMhQRNKWCFuIQ404oo8fIgUi/WJ16KF/MkY4400uKiejRDyCIOOKY4GY484DAfckCL6yEJpNCGp4ks4JlkkkzI5KaSSKBjJQZAlZsjhhvh1OCCKVnZJooYmMkgmlmaWeeJhO0b5pJxZ0giim1+mGSaYY8LJJZpe7qnnbuT16ReeggZKKHse2vkim4CemaeiFACJ6KIAHldopY7GSeSnUubY6Z+TSpqoqZiKyemadLYJqZp+Xhrgppoyaihnstaa6WOzSWCpIKfNamulVILoZ7C6qposn5wGgSKyvBoXrYCrFvvsWNBWJm0DLlrbHK3TgqsttRN0W+y3wy47qLC7cuuot1qmG66844prLpXotptttvcyma+y8+o7Vr/X3oXtwO+eG6/ABkdF8LEHN8zYw37tG/HECeO7MMD10stvxv5uzKy6lJKMarPS8XUxZfxae+5YuQbMscUSs7xyrx0zzBjNO9+8Lc8214wz0EP7TK7MIyO9rskx5zyz0eIS/TPUHlOtc9A9Cz211kc7nbTXSytdstgnM/3qqU1L3bXaUVv9NNdtw1213FcXTffbKW+d9d5Y920333/7rbfga7v9NdtzAz544Iwv7njhdx9ueNhgj1152WSnPbnliNf9eNyKQx466IST3rjopSeeuueon27656q7HjvsrL/eOu14r85xBA==","scale":0.25}
field5:{"type":"field","size":[74,14],"pos":[71,38],"locked":1,"border":0,"style":"plain","align":"center","value":"grid"}
field1:{"type":"field","size":[43,14],"pos":[182,83],"locked":1,"border":0,"style":"plain","align":"center","value":"ref"}

{script:findmulti.0}
on click pos do
 o:"[[0,0],[0,7],[7,0],[7,7]]"
 s:16*"%j" parse o
 g:ref.copy[]
 grid.brush:4
 grid.paste[g]
 each r i in path.find[s pos g]
  grid.pattern:colors.red+i
  grid.line[r]
 end
end
{end}

{card:limits}
{widgets}
button1:{"type":"button","size":[60,20],"pos":[442,316],"script":"Index.1","text":"Next","style":"rect"}
button2:{"type":"button","size":[60,20],"pos":[10,316],"script":"Index.1","text":"Prev","style":"rect"}
title:{"type":"field","size":[492,17],"pos":[10,19],"locked":1,"font":"menu","show":"invert","border":1,"align":"center","value":"path.find[]: limits"}
field2:{"type":"field","size":[236,269],"pos":[266,41],"locked":1,"border":0,"value":"There are some limitations to path.find[] that you should be aware of:\n\n- The maximum path length is 255 steps. If a route cannot be found within this limit, it will be treated as unreachable.\n\n- Calculating paths can be time-consuming. Avoid recomputing paths unnecessarily, and use the coarsest grid size and smallest grid that can suit your application."}
button5:{"type":"button","size":[60,20],"pos":[78,316],"script":"Index.1","text":"Index","style":"rect"}

{card:testblocked}
{widgets}
button1:{"type":"button","size":[60,20],"pos":[442,316],"script":"Index.1","text":"Next","style":"rect"}
button2:{"type":"button","size":[60,20],"pos":[10,316],"script":"Index.1","text":"Prev","style":"rect"}
title:{"type":"field","size":[492,17],"pos":[10,19],"locked":1,"font":"menu","show":"invert","border":1,"align":"center","value":"path.test[], path.testall[]"}
field2:{"type":"field","size":[236,269],"pos":[266,41],"locked":1,"border":0,"value":{"text":["In some situations you may want to directly consult the passability of cells within a grid, using the same approach as path.find[]. The path module exposes two approaches:\n\n","path.test[start grid etc]","\n\nreturn truthy if the specified START position is passable. coordinates outside the grid are considered non-passable.\n\n","path.testall[grid etc]","\n\nreturn an image interface filled with patterns 0 or 1, where 1 indicates a cell is passable. This is much more efficient than path.test[] if you need to query many cells at a time.\n\nboth of the above functions accept the same variations of widget/pair and card/image/canvas parameters as path.find[]."],"font":["","mono","","mono",""],"arg":["","","","",""]}}
button5:{"type":"button","size":[60,20],"pos":[78,316],"script":"Index.1","text":"Index","style":"rect"}
grid:{"type":"canvas","size":[128,128],"pos":[40,54],"locked":1,"script":"testblocked.0","image":"%%IMG3AIAAgASwyUlrAzjrDayfXJh9nyiSnhmilsqxlbvBlKzRoI3hkr7zvg7Qx7sQh7piUHnELZE2ZhIqk0apLmsVq9JmuSZvF3wir8wv9Ex9Y4/cP2eT9pRP7Vf8Vv/lj/1hcEKAZYRnhmmIa4ptjG+OcXRzMHWSd5Z5mHuafZx/noGQg6CFpIemiaiLqo2sQY+ukZSTLJWzl7eZuZu7nb2fv6Gxo8GlxafHqcmry63NsM+ytbQottO417rZvNu+3cDfwtHE4cblyOfK6czrzu3Q79LV1CTW89j32vnc+9794P/ExSMX0FxBdAfVJWS30F1DeA/l1aNXgmIKiy0wxtBYg2MOfBNBVhR5kWRGkxtRdlT5UV+RkDYCyJxJs2YAezD55fS3U8XNmDhHuhSqk6iLmzZtAvjJsodHp02N6ECalObSoCWHZi269ejSqjOvPpWq9WTZlEDBhmV6dmXbllzNyqCqVmxUrHJ5GvX5tS7buGgBuxUM16tamXbfQlVMlvDiuX3BJnbcWG9XgD1N0JX813JezHsFRrx6GCnewJ5Rg76sOXLVyakHxy68+nPr0rBrqxad2WDvEJtfd9Ytmzht3qFFBE+aGzlr38lfKSSxXGkAMc5tQ3+OkLpr5tcFYd+uvfuH6jWXjjfPfXp09x7QWw0vaj388vcryF9rn+Hv/MVlp9931vXn0H/+vZdgfASmR98wBkKE4IHnNThfhBIpSGF7C1qwH2IPjoMhQRNKWCFuIQ404oo8fIgUi/WJ16KF/MkY4400uKiejRDyCIOOKY4GY484DAfckCL6yEJpNCGp4ks4JlkkkzI5KaSSKBjJQZAlZsjhhvh1OCCKVnZJooYmMkgmlmaWeeJhO0b5pJxZ0giim1+mGSaYY8LJJZpe7qnnbuT16ReeggZKKHse2vkim4CemaeiFACJ6KIAHldopY7GSeSnUubY6Z+TSpqoqZiKyemadLYJqZp+Xhrgppoyaihnstaa6WOzSWCpIKfNamulVILoZ7C6qposn5wGgSKyvBoXrYCrFvvsWNBWJm0DLlrbHK3TgqsttRN0W+y3wy47qLC7cuuot1qmG66844prLpXotptttvcyma+y8+o7Vr/X3oXtwO+eG6/ABkdF8LEHN8zYw37tG/HECeO7MMD10stvxv5uzKy6lJKMarPS8XUxZfxae+5YuQbMscUSs7xyrx0zzBjNO9+8Lc8214wz0EP7TK7MIyO9rskx5zyz0eIS/TPUHlOtc9A9Cz211kc7nbTXSytdstgnM/3qqU1L3bXaUVv9NNdtw1213FcXTffbKW+d9d5Y920333/7rbfga7v9NdtzAz544Iwv7njhdx9ueNhgj1152WSnPbnliNf9eNyKQx466IST3rjopSeeuueon27656q7HjvsrL/eOu14r85xBA==","scale":1}
field5:{"type":"field","size":[74,14],"pos":[67,39],"locked":1,"border":0,"style":"plain","align":"center","value":"grid"}
viewer:{"type":"contraption","size":[250,120],"pos":[10,190],"def":"scriptViewer","widgets":{"o":{"size":[100,24],"pos":[273,1],"value":"grid"},"c":{"size":[250,18]},"i":{"size":[100,30],"pos":[273,38],"interval":[0,0]},"scr":{"size":[246,99]}}}
field1:{"type":"field","size":[71,35],"pos":[178,99],"locked":1,"border":0,"style":"plain","align":"center","value":"click on the grid to test passability!"}

{script:testblocked.0}
on click pos do
 p:path.test[pos grid]
 alert["passable: %b" format p]
end
{end}

{card:conversion}
{widgets}
button1:{"type":"button","size":[60,20],"pos":[442,316],"script":"Index.1","text":"Next","style":"rect"}
button2:{"type":"button","size":[60,20],"pos":[10,316],"script":"Index.1","text":"Prev","style":"rect"}
title:{"type":"field","size":[492,17],"pos":[10,19],"locked":1,"font":"menu","show":"invert","border":1,"align":"center","value":"path.to_cell[], path.to_pix[]"}
field2:{"type":"field","size":[236,269],"pos":[266,41],"locked":1,"border":0,"value":{"text":["You may also occasionally want to explicitly convert canvas drawing coordinates to grid cell coordinates, or vice versa:\n\n","path.to_cell[x grid etc]","\n\nconvert a pair or the centerpoint of a widget x (or a list of either) into cell coordinates with respect to a grid.\n\n","path.to_pix[x etc]","\n\nconvert a pair in cell coordinates (or a list of such pairs) to a pair giving the drawing coordinates of the center of the cell (or a list of such pairs).\n\nTry clicking on the grid to the left to see these coordinate transforms in action!"],"font":["","mono","","mono",""],"arg":["","","","",""]}}
button5:{"type":"button","size":[60,20],"pos":[78,316],"script":"Index.1","text":"Index","style":"rect"}
grid:{"type":"canvas","size":[128,128],"pos":[16,54],"locked":1,"script":"conversion.0","image":"%%IMG3AIAAgASwyUlrAzjrDayfXJh9nyiSnhmilsqxlbvBlKzRoI3hkr7zvg7Qx7sQh7piUHnELZE2ZhIqk0apLmsVq9JmuSZvF3wir8wv9Ex9Y4/cP2eT9pRP7Vf8Vv/lj/1hcEKAZYRnhmmIa4ptjG+OcXRzMHWSd5Z5mHuafZx/noGQg6CFpIemiaiLqo2sQY+ukZSTLJWzl7eZuZu7nb2fv6Gxo8GlxafHqcmry63NsM+ytbQottO417rZvNu+3cDfwtHE4cblyOfK6czrzu3Q79LV1CTW89j32vnc+9794P/ExSMX0FxBdAfVJWS30F1DeA/l1aNXgmIKiy0wxtBYg2MOfBNBVhR5kWRGkxtRdlT5UV+RkDYCyJxJs2YAezD55fS3U8XNmDhHuhSqk6iLmzZtAvjJsodHp02N6ECalObSoCWHZi269ejSqjOvPpWq9WTZlEDBhmV6dmXbllzNyqCqVmxUrHJ5GvX5tS7buGgBuxUM16tamXbfQlVMlvDiuX3BJnbcWG9XgD1N0JX813JezHsFRrx6GCnewJ5Rg76sOXLVyakHxy68+nPr0rBrqxad2WDvEJtfd9Ytmzht3qFFBE+aGzlr38lfKSSxXGkAMc5tQ3+OkLpr5tcFYd+uvfuH6jWXjjfPfXp09x7QWw0vaj388vcryF9rn+Hv/MVlp9931vXn0H/+vZdgfASmR98wBkKE4IHnNThfhBIpSGF7C1qwH2IPjoMhQRNKWCFuIQ404oo8fIgUi/WJ16KF/MkY4400uKiejRDyCIOOKY4GY484DAfckCL6yEJpNCGp4ks4JlkkkzI5KaSSKBjJQZAlZsjhhvh1OCCKVnZJooYmMkgmlmaWeeJhO0b5pJxZ0giim1+mGSaYY8LJJZpe7qnnbuT16ReeggZKKHse2vkim4CemaeiFACJ6KIAHldopY7GSeSnUubY6Z+TSpqoqZiKyemadLYJqZp+Xhrgppoyaihnstaa6WOzSWCpIKfNamulVILoZ7C6qposn5wGgSKyvBoXrYCrFvvsWNBWJm0DLlrbHK3TgqsttRN0W+y3wy47qLC7cuuot1qmG66844prLpXotptttvcyma+y8+o7Vr/X3oXtwO+eG6/ABkdF8LEHN8zYw37tG/HECeO7MMD10stvxv5uzKy6lJKMarPS8XUxZfxae+5YuQbMscUSs7xyrx0zzBjNO9+8Lc8214wz0EP7TK7MIyO9rskx5zyz0eIS/TPUHlOtc9A9Cz211kc7nbTXSytdstgnM/3qqU1L3bXaUVv9NNdtw1213FcXTffbKW+d9d5Y920333/7rbfga7v9NdtzAz544Iwv7njhdx9ueNhgj1152WSnPbnliNf9eNyKQx466IST3rjopSeeuueon27656q7HjvsrL/eOu14r85xBA==","scale":1}
field5:{"type":"field","size":[74,14],"pos":[37,39],"locked":1,"border":0,"style":"plain","align":"center","value":"grid"}
viewer:{"type":"contraption","size":[250,120],"pos":[10,190],"def":"scriptViewer","widgets":{"o":{"size":[100,24],"pos":[273,1],"value":"grid"},"c":{"size":[250,18]},"i":{"size":[100,30],"pos":[273,38],"interval":[0,0]},"scr":{"size":[246,99]}}}
orig:{"type":"field","size":[100,14],"pos":[153,69],"locked":1,"volatile":1,"style":"plain","align":"center"}
field3:{"type":"field","size":[74,14],"pos":[165,54],"locked":1,"border":0,"style":"plain","align":"center","value":"orig"}
cell:{"type":"field","size":[100,14],"pos":[153,108],"locked":1,"volatile":1,"style":"plain","align":"center"}
field4:{"type":"field","size":[74,14],"pos":[165,93],"locked":1,"border":0,"style":"plain","align":"center","value":"cell"}
center:{"type":"field","size":[100,14],"pos":[153,147],"locked":1,"volatile":1,"style":"plain","align":"center"}
field6:{"type":"field","size":[74,14],"pos":[165,132],"locked":1,"border":0,"style":"plain","align":"center","value":"center"}

{script:conversion.0}
on click pos do
 c:path.to_cell[pos grid]
 p:path.to_pix[c]
 orig  .data:pos
 cell  .data:c
 center.data:p
end
{end}

{card:closest}
{widgets}
button1:{"type":"button","size":[60,20],"pos":[442,316],"script":"Index.1","text":"Next","style":"rect"}
button2:{"type":"button","size":[60,20],"pos":[10,316],"script":"Index.1","text":"Prev","style":"rect"}
title:{"type":"field","size":[492,17],"pos":[10,19],"locked":1,"font":"menu","show":"invert","border":1,"align":"center","value":"path.closest[]"}
field2:{"type":"field","size":[236,269],"pos":[266,41],"locked":1,"border":0,"value":{"text":["Sometimes you may want to add some flexibility to START or GOAL positions when calculating a route. The path.closest[] function attempts to locate the nearest passable position on a grid to a provided position.\n\n","path.closest[start tol grid etc]","\n\n- START: a pair of coordinates or a widget.\n- TOL: the maximum distance to search, in grid cells.\n- GRID: an Image, Canvas, or Card.\n- ETC: a dictionary of optional parameters.\n\nIf path.closest[] is unable to find a passable route, it will return 0.\n\nIf etc.shuffle is truthy, this function will choose randomly among equally close cells.\n\nTry clicking on impassable tiles on the example to the left, and observe the \"best guess\" path."],"font":["","mono",""],"arg":["","",""]}}
button5:{"type":"button","size":[60,20],"pos":[78,316],"script":"Index.1","text":"Index","style":"rect"}
viewer:{"type":"contraption","size":[250,120],"pos":[10,190],"def":"scriptViewer","widgets":{"o":{"size":[100,24],"pos":[273,1],"value":"grid"},"c":{"size":[250,18]},"i":{"size":[100,30],"pos":[273,38],"interval":[0,0]},"scr":{"size":[246,99]}}}
grid:{"type":"canvas","size":[128,128],"pos":[46,54],"locked":1,"script":"closest.0","pattern":35,"image":"%%IMG3AIAAgAbAhnBILDYAyKRyCTA6h8xo8vmUSqlOaxRr1DK5Re8STBQryVAzEi1Ur9nuJtzNPtLn6npcf0fv8WZ8eYBigoFGI4mKi4yNjo5dfWR/fpJCj5iZmWGWXJSTlpqio4plnVifYKmkrJppg5WwoLINrbaPbadUqZ6dt7+LdrS9w6inwMi8xsW7ulW6mM5Z0pHMz9bRh7Has9yq0tlehoWE4uVaXOFW4+bbceTuUZjE3vTw3fffXvPN1tP+1eot24frmsB+Bw3ms6eFX8CFAyEilKiQIKSH7fBl1JfwXyCHrzpiRHduXckrtQqGpOiR5UiT8UimvJgLICebpnCuzOhQ2cSNDGVqFDqzUU2RN5HmVLqTaFFGwpgedZmU6lKI6qw2hTmUK0eJWZ1GBDpW7E+zTxfpnEr2rNegb4mE3XKSbsy4blFSmTum7pc6fpcEGEy4sOEAYkC2bFsR7WItiM1Etmg0r92uejFHQXz4MIDJlKE2xjs681cvnDsX/uxG8VbTcGGXtZJa9WDWrVVeZfyYdG8ptW3jzuPaZ+nLpyF/tn0bNDnFxn8jj715OfPh2kBGfynbMpPgqrHf60mtKm/u1Zk3X1Vwu3nH6L9bF+4c6Dz3u+G/pz0/fH2xfHV33F93AddfZ+K1FSCBmjGYHH/qcWbcgmcEVmGB6amXoGMUvoGhg9TJF+GGvqWliFZsvVNiEeAhGAA7TLi2n4DSgYhFi569aKGMr003G41G4GjYZzDKo9uMPnrXFxpCrqbjh0rwiF+PNlLRJGFEWpiEjFOmuCIRVzZX5BXFlZffl0OEydmYdEFnJpVLkqFmllBeqN2bXgLJ4oE5ssmgbl1GhWIDcz7ZYJwmnqmnokk+UaifiD6FZJUDRnojn0Ma+qBspUxqqZIXyompk5CGummjNX7q6KhYahqiqqma+qqsl0pW6hRaengorVZGSNitup5KKWDxwVosr476OhiwctSJq7PBcvHfZsxWm2uzoo7o6o+oHvvsrt+C8ei11kKLrbisiknuuubWMW677IIb7aXalivvubOGK226a8YrrLGeIuvEu/fa+6/AQfJLZ8H+5juvlQpvC6q+3A7r7cOr1ttwxQAzavGeGsMrMsNMRmyww/hyjDDIGkpc6coedwwnzGmafG2ggSrbass44ynoeXvGoW3Pa/2sH5j86iyhz0RLRWjSOpO46MwUT4zxwFArK3W3AVf9stdYKz0002QXrabSW38cM815co202DyX7XTOWfuatsxtq0311QnDfd20U+eNt9FoCnF21IC7vXfKVjOesd/+NT0o3ZBHLvfkPh+udeJ6C8424YE/rSJqkgO9NthBVn6dzyerjHrXfMPueKyvnx677bNfnLvsrTfe+9e3L/477cF7XrvwG/uePPC74z687s/zvjzxzSM/8sHHG1886IprX7330Ts/PfTjS389yuFbT/L62G9f+tHqt/89953TP/j7hdv/Of6h89+9/tkDoIrSB77yie98rnPf5UwXP/QZsIEJnJ//6jfB+y0QfgVEoPI0yDwCClCCF8xfBfcXwv6V8H8jDGAKFVi0FYKwhSekYAwtCMMazm2GJLQh5nTIwAyyz4EcpJ4HXViHIAA=","brush":4,"scale":1}
ref:{"type":"canvas","size":[32,32],"pos":[188,97],"locked":1,"image":"%%IMG3AIAAgASwyUlrAzjrDayfXJh9nyiSnhmilsqxlbvBlKzRoI3hkr7zvg7Qx7sQh7piUHnELZE2ZhIqk0apLmsVq9JmuSZvF3wir8wv9Ex9Y4/cP2eT9pRP7Vf8Vv/lj/1hcEKAZYRnhmmIa4ptjG+OcXRzMHWSd5Z5mHuafZx/noGQg6CFpIemiaiLqo2sQY+ukZSTLJWzl7eZuZu7nb2fv6Gxo8GlxafHqcmry63NsM+ytbQottO417rZvNu+3cDfwtHE4cblyOfK6czrzu3Q79LV1CTW89j32vnc+9794P/ExSMX0FxBdAfVJWS30F1DeA/l1aNXgmIKiy0wxtBYg2MOfBNBVhR5kWRGkxtRdlT5UV+RkDYCyJxJs2YAezD55fS3U8XNmDhHuhSqk6iLmzZtAvjJsodHp02N6ECalObSoCWHZi269ejSqjOvPpWq9WTZlEDBhmV6dmXbllzNyqCqVmxUrHJ5GvX5tS7buGgBuxUM16tamXbfQlVMlvDiuX3BJnbcWG9XgD1N0JX813JezHsFRrx6GCnewJ5Rg76sOXLVyakHxy68+nPr0rBrqxad2WDvEJtfd9Ytmzht3qFFBE+aGzlr38lfKSSxXGkAMc5tQ3+OkLpr5tcFYd+uvfuH6jWXjjfPfXp09x7QWw0vaj388vcryF9rn+Hv/MVlp9931vXn0H/+vZdgfASmR98wBkKE4IHnNThfhBIpSGF7C1qwH2IPjoMhQRNKWCFuIQ404oo8fIgUi/WJ16KF/MkY4400uKiejRDyCIOOKY4GY484DAfckCL6yEJpNCGp4ks4JlkkkzI5KaSSKBjJQZAlZsjhhvh1OCCKVnZJooYmMkgmlmaWeeJhO0b5pJxZ0giim1+mGSaYY8LJJZpe7qnnbuT16ReeggZKKHse2vkim4CemaeiFACJ6KIAHldopY7GSeSnUubY6Z+TSpqoqZiKyemadLYJqZp+Xhrgppoyaihnstaa6WOzSWCpIKfNamulVILoZ7C6qposn5wGgSKyvBoXrYCrFvvsWNBWJm0DLlrbHK3TgqsttRN0W+y3wy47qLC7cuuot1qmG66844prLpXotptttvcyma+y8+o7Vr/X3oXtwO+eG6/ABkdF8LEHN8zYw37tG/HECeO7MMD10stvxv5uzKy6lJKMarPS8XUxZfxae+5YuQbMscUSs7xyrx0zzBjNO9+8Lc8214wz0EP7TK7MIyO9rskx5zyz0eIS/TPUHlOtc9A9Cz211kc7nbTXSytdstgnM/3qqU1L3bXaUVv9NNdtw1213FcXTffbKW+d9d5Y920333/7rbfga7v9NdtzAz544Iwv7njhdx9ueNhgj1152WSnPbnliNf9eNyKQx466IST3rjopSeeuueon27656q7HjvsrL/eOu14r85xBA==","scale":0.25}
field5:{"type":"field","size":[74,14],"pos":[71,38],"locked":1,"border":0,"style":"plain","align":"center","value":"grid"}
field1:{"type":"field","size":[43,14],"pos":[182,83],"locked":1,"border":0,"style":"plain","align":"center","value":"ref"}

{script:closest.0}
on click pos do
 g:ref.copy[]
 c:path.closest[pos 2 g ().shuffle:1]
 p:path.find[0,0 c g]
 grid.pattern:colors.red
 grid.brush:4
 grid.paste[g]
 grid.line[p]
end
{end}

{card:followerContraption}
{widgets}
button1:{"type":"button","size":[60,20],"pos":[442,316],"script":"Index.1","text":"Next","style":"rect"}
button2:{"type":"button","size":[60,20],"pos":[10,316],"script":"Index.1","text":"Prev","style":"rect"}
title:{"type":"field","size":[492,17],"pos":[10,19],"locked":1,"font":"menu","show":"invert","border":1,"align":"center","value":"the Follower contraption"}
field2:{"type":"field","size":[236,269],"pos":[266,41],"locked":1,"border":0,"value":"The Follower contraption is a handy companion to the \"path\" module, offering a self-animating entity that can move along computed routes.\n\n-follower.path: a list of screen-space coordinates upon which to center the follower in sequence. Writing a 0 cancels movement.\n\n- follower.done: has movement completed? (read-only).\n\n- follower.speed: how many frames of animation does it take to carry out one step in a path? (A higher number means slower movement.)\n\n- follower.aux: auxiliary storage for any lil data\n\n- follower.image: the visual appearance of the follower, drawn centered within its bounding box.\n\n- follower.show: control transparency or hide the contraption.\n\n- follower.animate[]: an alternative to the follower's internal animation pump, if you want it to move during a \"synchronous\" blocking script."}
button5:{"type":"button","size":[60,20],"pos":[78,316],"script":"Index.1","text":"Index","style":"rect"}
grid:{"type":"canvas","size":[128,128],"pos":[33,54],"locked":1,"script":"followerContraption.0","image":"%%IMG3AIAAgASwyUlrAzjrDayfXJh9nyiSnhmilsqxlbvBlKzRoI3hkr7zvg7Qx7sQh7piUHnELZE2ZhIqk0apLmsVq9JmuSZvF3wir8wv9Ex9Y4/cP2eT9pRP7Vf8Vv/lj/1hcEKAZYRnhmmIa4ptjG+OcXRzMHWSd5Z5mHuafZx/noGQg6CFpIemiaiLqo2sQY+ukZSTLJWzl7eZuZu7nb2fv6Gxo8GlxafHqcmry63NsM+ytbQottO417rZvNu+3cDfwtHE4cblyOfK6czrzu3Q79LV1CTW89j32vnc+9794P/ExSMX0FxBdAfVJWS30F1DeA/l1aNXgmIKiy0wxtBYg2MOfBNBVhR5kWRGkxtRdlT5UV+RkDYCyJxJs2YAezD55fS3U8XNmDhHuhSqk6iLmzZtAvjJsodHp02N6ECalObSoCWHZi269ejSqjOvPpWq9WTZlEDBhmV6dmXbllzNyqCqVmxUrHJ5GvX5tS7buGgBuxUM16tamXbfQlVMlvDiuX3BJnbcWG9XgD1N0JX813JezHsFRrx6GCnewJ5Rg76sOXLVyakHxy68+nPr0rBrqxad2WDvEJtfd9Ytmzht3qFFBE+aGzlr38lfKSSxXGkAMc5tQ3+OkLpr5tcFYd+uvfuH6jWXjjfPfXp09x7QWw0vaj388vcryF9rn+Hv/MVlp9931vXn0H/+vZdgfASmR98wBkKE4IHnNThfhBIpSGF7C1qwH2IPjoMhQRNKWCFuIQ404oo8fIgUi/WJ16KF/MkY4400uKiejRDyCIOOKY4GY484DAfckCL6yEJpNCGp4ks4JlkkkzI5KaSSKBjJQZAlZsjhhvh1OCCKVnZJooYmMkgmlmaWeeJhO0b5pJxZ0giim1+mGSaYY8LJJZpe7qnnbuT16ReeggZKKHse2vkim4CemaeiFACJ6KIAHldopY7GSeSnUubY6Z+TSpqoqZiKyemadLYJqZp+Xhrgppoyaihnstaa6WOzSWCpIKfNamulVILoZ7C6qposn5wGgSKyvBoXrYCrFvvsWNBWJm0DLlrbHK3TgqsttRN0W+y3wy47qLC7cuuot1qmG66844prLpXotptttvcyma+y8+o7Vr/X3oXtwO+eG6/ABkdF8LEHN8zYw37tG/HECeO7MMD10stvxv5uzKy6lJKMarPS8XUxZfxae+5YuQbMscUSs7xyrx0zzBjNO9+8Lc8214wz0EP7TK7MIyO9rskx5zyz0eIS/TPUHlOtc9A9Cz211kc7nbTXSytdstgnM/3qqU1L3bXaUVv9NNdtw1213FcXTffbKW+d9d5Y920333/7rbfga7v9NdtzAz544Iwv7njhdx9ueNhgj1152WSnPbnliNf9eNyKQx466IST3rjopSeeuueon27656q7HjvsrL/eOu14r85xBA==","scale":1}
f:{"type":"contraption","size":[16,16],"pos":[81,134],"show":"transparent","def":"follower","widgets":{"c":{"size":[16,16],"show":"transparent"},"si":{"pos":[52,-38]},"ss":{"size":[100,12],"pos":[52,-11]},"sd":{"size":[100,3],"pos":[52,3]},"sp":{"size":[100,3],"pos":[52,7],"value":"{}"},"sa":{"size":[100,3],"pos":[52,11]}}}
field5:{"type":"field","size":[74,14],"pos":[60,39],"locked":1,"border":0,"style":"plain","align":"center","value":"grid"}
viewer:{"type":"contraption","size":[250,120],"pos":[10,190],"def":"scriptViewer","widgets":{"o":{"size":[100,24],"pos":[273,1],"value":"grid"},"c":{"size":[250,18]},"i":{"size":[100,30],"pos":[273,38],"interval":[0,0]},"scr":{"size":[246,99]}}}
field1:{"type":"field","size":[79,36],"pos":[172,99],"locked":1,"border":0,"style":"plain","align":"center","value":"click anywhere on the board to move the pawn!"}

{script:followerContraption.0}
on click pos do
 f.path:path.find[f pos grid]
end
{end}

{card:followermovement}
{widgets}
button1:{"type":"button","size":[60,20],"pos":[442,316],"script":"Index.1","text":"Next","style":"rect"}
button2:{"type":"button","size":[60,20],"pos":[10,316],"script":"Index.1","text":"Prev","style":"rect"}
title:{"type":"field","size":[492,17],"pos":[10,19],"locked":1,"font":"menu","show":"invert","border":1,"align":"center","value":"Follower movement events"}
field2:{"type":"field","size":[236,269],"pos":[266,41],"locked":1,"border":0,"value":"The Follower contraption emits several events while it travels along an assigned route:\n\n- step[]: called each time a step on the route is completed.\n\n- finish[]: called once when an entire route is completed. Not called if a route is canceled!\n\n- tween[t a b]: called multiple times over the course of each step in the route. \"a\" and \"b\" are pairs in screen coordinates and \"t\" is a tweening value that ranges from 0 to 1. If this event handler is defined and returns a coordinate pair, the follower will center itself on those screen coordinates for that frame of the animation; otherwise it will linearly interpolate itself from \"a\" to \"b\".\n\nAny of these event handlers can offer good opportunities for driving animation by redefining follower.sprite!"}
button5:{"type":"button","size":[60,20],"pos":[78,316],"script":"Index.1","text":"Index","style":"rect"}
grid:{"type":"canvas","size":[128,128],"pos":[10,54],"locked":1,"script":"followermovement.0","image":"%%IMG3AIAAgASwyUlrAzjrDayfXJh9nyiSnhmilsqxlbvBlKzRoI3hkr7zvg7Qx7sQh7piUHnELZE2ZhIqk0apLmsVq9JmuSZvF3wir8wv9Ex9Y4/cP2eT9pRP7Vf8Vv/lj/1hcEKAZYRnhmmIa4ptjG+OcXRzMHWSd5Z5mHuafZx/noGQg6CFpIemiaiLqo2sQY+ukZSTLJWzl7eZuZu7nb2fv6Gxo8GlxafHqcmry63NsM+ytbQottO417rZvNu+3cDfwtHE4cblyOfK6czrzu3Q79LV1CTW89j32vnc+9794P/ExSMX0FxBdAfVJWS30F1DeA/l1aNXgmIKiy0wxtBYg2MOfBNBVhR5kWRGkxtRdlT5UV+RkDYCyJxJs2YAezD55fS3U8XNmDhHuhSqk6iLmzZtAvjJsodHp02N6ECalObSoCWHZi269ejSqjOvPpWq9WTZlEDBhmV6dmXbllzNyqCqVmxUrHJ5GvX5tS7buGgBuxUM16tamXbfQlVMlvDiuX3BJnbcWG9XgD1N0JX813JezHsFRrx6GCnewJ5Rg76sOXLVyakHxy68+nPr0rBrqxad2WDvEJtfd9Ytmzht3qFFBE+aGzlr38lfKSSxXGkAMc5tQ3+OkLpr5tcFYd+uvfuH6jWXjjfPfXp09x7QWw0vaj388vcryF9rn+Hv/MVlp9931vXn0H/+vZdgfASmR98wBkKE4IHnNThfhBIpSGF7C1qwH2IPjoMhQRNKWCFuIQ404oo8fIgUi/WJ16KF/MkY4400uKiejRDyCIOOKY4GY484DAfckCL6yEJpNCGp4ks4JlkkkzI5KaSSKBjJQZAlZsjhhvh1OCCKVnZJooYmMkgmlmaWeeJhO0b5pJxZ0giim1+mGSaYY8LJJZpe7qnnbuT16ReeggZKKHse2vkim4CemaeiFACJ6KIAHldopY7GSeSnUubY6Z+TSpqoqZiKyemadLYJqZp+Xhrgppoyaihnstaa6WOzSWCpIKfNamulVILoZ7C6qposn5wGgSKyvBoXrYCrFvvsWNBWJm0DLlrbHK3TgqsttRN0W+y3wy47qLC7cuuot1qmG66844prLpXotptttvcyma+y8+o7Vr/X3oXtwO+eG6/ABkdF8LEHN8zYw37tG/HECeO7MMD10stvxv5uzKy6lJKMarPS8XUxZfxae+5YuQbMscUSs7xyrx0zzBjNO9+8Lc8214wz0EP7TK7MIyO9rskx5zyz0eIS/TPUHlOtc9A9Cz211kc7nbTXSytdstgnM/3qqU1L3bXaUVv9NNdtw1213FcXTffbKW+d9d5Y920333/7rbfga7v9NdtzAz544Iwv7njhdx9ueNhgj1152WSnPbnliNf9eNyKQx466IST3rjopSeeuueon27656q7HjvsrL/eOu14r85xBA==","scale":1}
f:{"type":"contraption","size":[16,16],"pos":[74,118],"script":"followermovement.1","show":"transparent","def":"follower","widgets":{"c":{"size":[16,16],"show":"transparent"},"si":{"pos":[52,-38]},"ss":{"size":[100,12],"pos":[52,-11],"value":"20"},"sd":{"size":[100,3],"pos":[52,3]},"sp":{"size":[100,3],"pos":[52,7],"value":"{}"},"sa":{"size":[100,3],"pos":[52,11]}}}
field5:{"type":"field","size":[74,14],"pos":[37,39],"locked":1,"border":0,"style":"plain","align":"center","value":"grid"}
viewer:{"type":"contraption","size":[250,120],"pos":[10,190],"def":"scriptViewer","widgets":{"o":{"size":[100,24],"pos":[273,1],"value":"grid\nf"},"c":{"size":[250,18]},"i":{"size":[100,30],"pos":[273,38],"interval":[0,1],"value":1},"scr":{"size":[246,99]}}}
log:{"type":"field","size":[116,129],"pos":[144,53],"volatile":1,"scrollbar":1,"style":"plain"}
field11:{"type":"field","size":[74,14],"pos":[162,38],"locked":1,"border":0,"style":"plain","align":"center","value":"log"}

{script:followermovement.0}
on click pos do
 log.text:""
 p:path.find[f pos grid]
 if p~nil log.text:"thud."
 else f.path:p
 end
end
{end}

{script:followermovement.1}
on tween t a b do
 ((1,-4)*sin t*pi)+ # bounce
 a+(b-a)*t^2        # quad ease-in
end

on finish do
 record["finish!"]
end

on step do
 record["step %i,%i" format me.pos]
end

on record x do
 log.text:log.text,"\n",x
 log.scroll:999999
end
{end}

{card:followerinteraction}
{widgets}
button1:{"type":"button","size":[60,20],"pos":[442,316],"script":"Index.1","text":"Next","style":"rect"}
button2:{"type":"button","size":[60,20],"pos":[10,316],"script":"Index.1","text":"Prev","style":"rect"}
title:{"type":"field","size":[492,17],"pos":[10,19],"locked":1,"font":"menu","show":"invert","border":1,"align":"center","value":"Follower interaction events"}
field2:{"type":"field","size":[236,269],"pos":[266,41],"locked":1,"border":0,"value":"The Follower contraption also supports direct interaction:\n\n- follower.draggable: if truthy, the user can click and drag to reposition this contraption.\n\n- follower.locked: if truthy, disable clicks/dragging and pause movement.\n\n- click[]: fired when the user clicks this contraption.\n\n- release[]: fired when the user completes a drag operation (if draggable)."}
button5:{"type":"button","size":[60,20],"pos":[78,316],"script":"Index.1","text":"Index","style":"rect"}
grid:{"type":"canvas","size":[128,128],"pos":[37,53],"locked":1,"image":"%%IMG3AIAAgASwyUlrAzjrDayfXJh9nyiSnhmilsqxlbvBlKzRoI3hkr7zvg7Qx7sQh7piUHnELZE2ZhIqk0apLmsVq9JmuSZvF3wir8wv9Ex9Y4/cP2eT9pRP7Vf8Vv/lj/1hcEKAZYRnhmmIa4ptjG+OcXRzMHWSd5Z5mHuafZx/noGQg6CFpIemiaiLqo2sQY+ukZSTLJWzl7eZuZu7nb2fv6Gxo8GlxafHqcmry63NsM+ytbQottO417rZvNu+3cDfwtHE4cblyOfK6czrzu3Q79LV1CTW89j32vnc+9794P/ExSMX0FxBdAfVJWS30F1DeA/l1aNXgmIKiy0wxtBYg2MOfBNBVhR5kWRGkxtRdlT5UV+RkDYCyJxJs2YAezD55fS3U8XNmDhHuhSqk6iLmzZtAvjJsodHp02N6ECalObSoCWHZi269ejSqjOvPpWq9WTZlEDBhmV6dmXbllzNyqCqVmxUrHJ5GvX5tS7buGgBuxUM16tamXbfQlVMlvDiuX3BJnbcWG9XgD1N0JX813JezHsFRrx6GCnewJ5Rg76sOXLVyakHxy68+nPr0rBrqxad2WDvEJtfd9Ytmzht3qFFBE+aGzlr38lfKSSxXGkAMc5tQ3+OkLpr5tcFYd+uvfuH6jWXjjfPfXp09x7QWw0vaj388vcryF9rn+Hv/MVlp9931vXn0H/+vZdgfASmR98wBkKE4IHnNThfhBIpSGF7C1qwH2IPjoMhQRNKWCFuIQ404oo8fIgUi/WJ16KF/MkY4400uKiejRDyCIOOKY4GY484DAfckCL6yEJpNCGp4ks4JlkkkzI5KaSSKBjJQZAlZsjhhvh1OCCKVnZJooYmMkgmlmaWeeJhO0b5pJxZ0giim1+mGSaYY8LJJZpe7qnnbuT16ReeggZKKHse2vkim4CemaeiFACJ6KIAHldopY7GSeSnUubY6Z+TSpqoqZiKyemadLYJqZp+Xhrgppoyaihnstaa6WOzSWCpIKfNamulVILoZ7C6qposn5wGgSKyvBoXrYCrFvvsWNBWJm0DLlrbHK3TgqsttRN0W+y3wy47qLC7cuuot1qmG66844prLpXotptttvcyma+y8+o7Vr/X3oXtwO+eG6/ABkdF8LEHN8zYw37tG/HECeO7MMD10stvxv5uzKy6lJKMarPS8XUxZfxae+5YuQbMscUSs7xyrx0zzBjNO9+8Lc8214wz0EP7TK7MIyO9rskx5zyz0eIS/TPUHlOtc9A9Cz211kc7nbTXSytdstgnM/3qqU1L3bXaUVv9NNdtw1213FcXTffbKW+d9d5Y920333/7rbfga7v9NdtzAz544Iwv7njhdx9ueNhgj1152WSnPbnliNf9eNyKQx466IST3rjopSeeuueon27656q7HjvsrL/eOu14r85xBA==","scale":1}
f:{"type":"contraption","size":[16,16],"pos":[53,69],"script":"followerinteraction.0","show":"transparent","def":"follower","widgets":{"c":{"size":[16,16],"show":"transparent","draggable":1},"si":{"pos":[52,-38]},"ss":{"size":[100,12],"pos":[52,-11]},"sd":{"size":[100,3],"pos":[52,3],"value":1},"sp":{"size":[100,3],"pos":[52,7],"value":"{}"},"sa":{"size":[100,3],"pos":[52,11]}}}
field5:{"type":"field","size":[74,14],"pos":[64,38],"locked":1,"border":0,"style":"plain","align":"center","value":"grid"}
viewer:{"type":"contraption","size":[250,120],"pos":[10,190],"def":"scriptViewer","widgets":{"o":{"size":[100,24],"pos":[273,1],"value":"f"},"c":{"size":[250,18]},"i":{"size":[100,30],"pos":[273,38],"interval":[0,0]},"scr":{"size":[246,99]}}}
field1:{"type":"field","size":[70,45],"pos":[177,96],"locked":1,"border":0,"style":"plain","align":"center","value":"drag the pawn somewhere else on the board!"}

{script:followerinteraction.0}
on release do
 f.path:path.find[f 16,16 grid]
end
{end}

{card:followeranim}
image:"%%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"
{widgets}
button1:{"type":"button","size":[60,20],"pos":[442,316],"script":"Index.1","text":"Index","style":"rect"}
button2:{"type":"button","size":[60,20],"pos":[10,316],"script":"Index.1","text":"Prev","style":"rect"}
title:{"type":"field","size":[492,17],"pos":[10,19],"locked":1,"font":"menu","show":"invert","border":1,"align":"center","value":"Follower animation demo"}
field2:{"type":"field","size":[236,105],"pos":[266,205],"locked":1,"border":0,"value":"This demo uses the card background as the grid, with an orange color as the impassable marker. By manipulating Decker's palette it can be made visually indistinguishable from black pixels. Alternatively, you could store the passability mask on a separate card from the visible graphics.\n\nThis also demonstrates dynamically altering a Follower's \".sprite\" attribute to animate it."}
f:{"type":"contraption","size":[16,16],"pos":[160,96],"script":"followeranim.0","show":"transparent","def":"follower","widgets":{"c":{"size":[16,16],"show":"transparent"},"si":{"pos":[52,-38],"value":{"text":["i"],"font":[""],"arg":["%%IMG3ABAAEAZAgHBILBYDyCTSCAiAntBn4BitgqZDpxWKFWq3V+J3221KtUgplcxUKple7BLelJeN8zldTo/74Xp1REE="]}},"ss":{"size":[100,12],"pos":[52,-11],"value":"7"},"sd":{"size":[100,3],"pos":[52,3]},"sp":{"size":[100,3],"pos":[52,7],"value":"{\"path\":0}"},"sa":{"size":[100,3],"pos":[52,11],"value":"\"dn\""}}}
viewer:{"type":"contraption","size":[250,120],"pos":[10,190],"def":"scriptViewer","widgets":{"o":{"size":[100,24],"pos":[273,1],"value":"f\npump"},"c":{"size":[250,18]},"i":{"size":[100,30],"pos":[273,38],"interval":[0,1],"value":1},"scr":{"size":[246,99]}}}
pump:{"type":"button","size":[16,15],"pos":[418,319],"locked":1,"animated":1,"script":"followeranim.1","style":"invisible"}
anims:{"type":"field","size":[26,18],"pos":[382,318],"show":"none","value":"{\"dn\":[%%IMG2ABAAEAAUAQgABwEBIAgBAQAFAQEgCgEBAAQBASAKAQEABAEBIAoBAQAEAQEgCgEBAAQBASACAQIgAgECIAIBAQAFAQEgCAEBAAcBCAAJAQIAAgECAAoBAgACAQIACgECAAIBAgALAQEAAgEBAAsBAgACAQIACQECAAQBAgAE,%%IMG2ABAAEAAEAQgABwEBIAgBAQAFAQEgCgEBAAQBASAKAQEABAEBIAoBAQAEAQEgCgEBAAQBASACAQIgAgECIAIBAQAFAQEgCAEBAAcBCAAJAQIAAgECAAgBBAACAQIACQEDAAIBAgAKAQEAAgECAA4BAgANAQIAEAEBAAY=,%%IMG2ABAAEAAEAQgABwEBIAgBAQAFAQEgCgEBAAQBASAKAQEABAEBIAoBAQAEAQEgCgEBAAQBASACAQIgAgECIAIBAQAFAQEgCAEBAAcBCAAJAQIAAgECAAoBAgACAQQACAECAAIBAwAKAQIAAgEBAAsBAgAPAQIADQEBAAk=],\"lf\":[%%IMG2ABAAEAAUAQgABwEBIAgBAQAFAQEgCgEBAAQBASAKAQEABAEBIAoBAQAEAQEgCgEBAAQBAyAGAQIABgEBIAYBAwAHAQgACgECAAEBAgALAQIAAQECAAwBAgABAQEADAEBAAEBAQAMAQEAAQECAAoBAgABAQIABw==,%%IMG2ABAAEAAEAQgABwEBIAgBAQAFAQEgCgEBAAQBASAKAQEABAEBIAoBAQAEAQEgCgEBAAQBAyAGAQIABgEBIAYBAwAHAQgACgEEAAkBAwABAQQABwEBAAEBBwAHAQEABgECAA8BAgAOAQIADQECAAU=,%%IMG2ABAAEAAEAQgABwEBIAgBAQAFAQEgCgEBAAQBASAKAQEABAEBIAoBAQAEAQEgCgEBAAQBAyAGAQIABgEBIAYBAwAHAQgACQEFAAwBBAALAQUACQEDAAIBAgAIAQMAAwEDAAYBAQAIAQEADwECAAQ=],\"rt\":[%%IMG2ABAAEAAUAQgABwEBIAgBAQAFAQEgCgEBAAQBASAKAQEABAEBIAoBAQAEAQEgCgEBAAUBAiAGAQMABQEDIAYBAQAHAQgACQECAAEBAgALAQIAAQECAAsBAQABAQIADQEBAAEBAQANAQIAAQEBAA0BAgABAQIABA==,%%IMG2ABAAEAAEAQgABwEBIAgBAQAFAQEgCgEBAAQBASAKAQEABAEBIAoBAQAEAQEgCgEBAAUBAiAGAQMABQEDIAYBAQAHAQgACgEEAAsBBAABAQMACAEHAAEBAQAHAQIABgEBAAYBAgAOAQIADwECAAk=,%%IMG2ABAAEAAEAQgABwEBIAgBAQAFAQEgCgEBAAQBASAKAQEABAEBIAoBAQAEAQEgCgEBAAUBAiAGAQMABQEDIAYBAQAHAQgACgEFAAsBBAAMAQUACwECAAIBAwAIAQMAAwEDAAcBAQAIAQEABQECAAo=],\"up\":[%%IMG2ABAAEAAUAQgABwEBIAgBAQAFAQEgCgEBAAQBASAKAQEABAEBIAoBAQAEAQEgCgEBAAQBASAEAQIgBAEBAAUBASABAQYgAQEBAAcBCAAJAQIAAgECAAoBAgACAQIACgECAAIBAgALAQEAAgEBAAsBAgACAQIACQECAAQBAgAE,%%IMG2ABAAEAAEAQgABwEBIAgBAQAFAQEgCgEBAAQBASAKAQEABAEBIAoBAQAEAQEgCgEBAAQBASAEAQIgBAEBAAUBASABAQYgAQEBAAcBCAAJAQIAAgECAAgBBAACAQIACQEDAAIBAgAKAQEAAgECAA4BAgANAQIAEAEBAAY=,%%IMG2ABAAEAAEAQgABwEBIAgBAQAFAQEgCgEBAAQBASAKAQEABAEBIAoBAQAEAQEgCgEBAAQBASAEAQIgBAEBAAUBASABAQYgAQEBAAcBCAAJAQIAAgECAAoBAgACAQQACAECAAIBAwAKAQIAAgEBAAsBAgAPAQIADQEBAAk=]}"}
field1:{"type":"field","size":[100,26],"pos":[228,150],"locked":1,"border":0,"style":"plain","align":"center","value":"click anywhere to move the little fella!"}
button3:{"type":"button","size":[179,20],"pos":[170,316],"script":"followeranim.2","text":"Show Impassable Regions","style":"check","value":0}

{script:followeranim.0}
on tween t a b do
 dir:b-a
 face:if dir[0]<0 "lf"
 elseif  dir[0]>0 "rt"
 elseif  dir[1]<0 "up"
 else             "dn" end
 ix:(0,1,0,2)[4%sys.frame/4]
 me.sprite:anims.data[face][ix]
 me.aux:face
 0 # use default tweening
end

on finish do
 me.sprite:anims.data[me.aux][0]
end
{end}

{script:followeranim.1}
on view do
 if pointer.down
  etc.move:"ortho"
  etc.block:list colors.orange
  g:pointer.pos
  f.path:path.find[f g card etc]
 end
end
{end}

{script:followeranim.2}
on click do
 patterns[colors.orange]:me.value * 16737536
end
{end}

{card:card1}
image:"%%IMG3AgABVgZAgHBILBqPyKRyyWw6n9CodEqtWq/YrHbL7Xq/4LB4TC6bz+i0es1uu9/wuHxOr9vv+Lx+z+/7/4CBgoOEhYaHiImKi4yNjo+QkZKTlJWWl5iZmpucnZ6foKGio6SlpqeoqaqrrK2ur7CxsrO0tba3uLm6u7y9vr/AwcLDxMXGx8jJysvMzc7P0NHS09TV1tfY2drb3N3e3+Dh4uPk5ebn6Onq6+zt7u/w8fLz9PX29/j5+vv8/f7/AAMKHEiwoMGDCBMqXMiwocOHECNKnEixosWLGDNq3Mixo8ePIEOKHEmypMmTKFOqXMmypcuXMGPKnEmzps2bOHPq3Mmzp8+fQIMKHUq0qNGjSJMqXcq0qdOnUKNKnUq1qtWrWLNq3cq1q9evYMOKHUu2rNmzaNOqXcu2rdu3cOPKnUu3rt27ePPq3cu3r9+/gAMLHky4sOHDiBMrXsy4sePHkCNLzhagsuXKSC5fnlxMs+UjAUCIHi06gJHQpEeb5hwMdWoQq4e4fg2byOzXsVnzup06N2/Svmmr1u3r93DZwkvbTl6b+G7mwZNHF57bOS7jypHDRl05uxDu4L1bv146fHPtuE9TH/+cdvXvnt/D98y+V3z58PMnwQyAf/3dq/lXxGb94acfgf/lwp+AAy5oYIHzJbiLg0oE+OCBEu72nRMMgnZhhrJQuESHmX0IoisCkngaEyaeWFx8JdLnIi33gbbegDfOCItx1WF3Xn/Q6fiKj9O5t5x0QqIYJHpGMplekqwQeWSOQCIJ5SpSytZdbz1uCVyLV3piGW7v8fYZjlyCGWYnZpJYo4cyrokljPudWaedcraCmYqfIRijmnl+sqd8ptH5J6CBilkoaKfhd6aKiZqy6BMd2olnpKcUqiaDjmKKyqBQQNqop7a82WicpIpi6pS9qddkqqDwiCaVWcLK5pLf4VollbZqUuuurwL7ZK+b/GqsrsRicqxqsxXp5Y/JXtJsszh6Bi2Q1iIarSKhZQunZodeuq2yho4KYZ36jcuJiKdaWKGFoqobCbunputhhPL66u5+9pa4Yb7F/svih/ECLAm9/jZRsMGOpGgiwQxHLPHEFFds8cUYZ6zxxhx37PHHIIcs8sgkl2zyySinrPLKLLfs8sswxyzzzDTXbPPNOOes88489+zzz0AHLfTQRBdt9NFIJ6300kw37fTTUEct9dRUV2311VhnrfXWXHft9ddghy322GSXbfbZaKet9tpst+3223DHLffcdNdt991456333nz37fffgAcu+OCEF2744YgnrvjijDfu+OOQRy755JRXbvnlmGeu+eacd+7556CHLvropJdu+umop6766qy37vrrsMcu++y012777bjnrvvuvPfu++/ABy/88MQXb/zxyCev/PLMN+/889DXHgQ="
{widgets}
sprites:{"type":"button","size":[48,48],"pos":[80,112],"show":"none"}
field1:{"type":"field","size":[112,48],"pos":[80,48],"locked":1,"value":"This is how the sprites for the follower animation demo were prepared:"}
data:{"type":"field","size":[144,112],"pos":[80,176],"volatile":1,"scrollbar":1}
button1:{"type":"button","size":[60,20],"pos":[144,128],"script":"card1.0","text":"Export"}

{script:card1.0}
on click do
 s:16,16
 i:card.image.copy[sprites.pos sprites.size]
 frames:each pos in flip s*flip 3 cross 3 i.copy[pos s] end
 
 anim.dn: frames @ 0,1,2
 anim.lf: frames @ 3,4,5
 anim.rt:(frames @ 3,4,5)..copy[].transform.horiz
 anim.up: frames @ 6,7,8
 
 data.data:anim
end
{end}

{module:path}
description:"generic grid-based pathfinding routines"
version:1.2
{script}
local default_cell:16,16
local minusone:0|-1+range 256
local rects:"|"split"field|button|canvas|grid|slider|contraption|dict"
local deltas:"%j" parse "{l}
 'ortho'    :[[-1,0],[0,-1],[1,0],[0,1]],
 'diag'     :[[-1,-1],[1,-1],[1,1],[-1,1]],
 'orthodiag':[[-1,0],[0,-1],[1,0],[0,1],[-1,-1],[1,-1],[1,1],[-1,1]],
{r}"
on is_rect x do (typeof x) in rects     end
on is_pair x do "number"~typeof first x end

module.to_cell:on to_cell x mask etc do
 local off:(0,0) unless mask.pos
 local cell:default_cell unless etc.cell
 on scr_to_cell x do floor ((-off)+x.pos+.5*x.size)/cell end # rect
 on rel_to_cell x do floor x                       /cell end # pair
 # pos can be a pair, rect, or list of pairs/rects
 if     is_rect[x]  scr_to_cell[x]
 elseif is_pair[x]  rel_to_cell[x]
 else
  each v in x
   if is_rect[v] scr_to_cell[v] else rel_to_cell[v] end
  end
 end
end
module.to_pix:on to_pix x etc do
 local cell:default_cell unless etc.cell
 if x
  if is_pair[x] (.5*cell)+cell*x   # single pair
  else flip (.5*cell)+cell*flip x  # list of pairs
  end
 end
end

module.test_cell:on test_cell pos mask etc do
 if "card"~typeof mask  mask:mask.image end       # card | canvas | image
 local cell :default_cell unless etc.cell         # pair
 local block:(list 1) unless etc.block            # list
 local s:floor mask.size/cell
 (min(pos>-1)&(pos<s))&!sum mask.copy[pos*cell cell].hist @ block
end
module.test:on test pos mask etc do
 test_cell[to_cell[pos] mask etc]
end
module.testall:on testall mask etc do
 if "card"~typeof mask  mask:mask.image end       # card | canvas | image
 local cell :default_cell unless etc.cell         # pair
 local block:(list 1) unless etc.block            # list
 local s:floor mask.size/cell
 local r:image[s]
 r.pixels:each pos in s[0] cross s[1]
  !sum mask.copy[pos*cell cell].hist @ block
 end
 r
end

module.find_cell:on find_cell start goal mask etc do
 start:floor start                                # pair | list-of-pair
 goal :floor goal                                 # pair
 local tmove:deltas["orthodiag" unless etc.move]  # str | list-of-pair
 if tmove~nil tmove:etc.move end
 local move :flip tmove                           # str
 local p:testall[mask etc]
 # parallel flood-fill maximum scent:
 local changed:1
 local v:image[p.size]
 v[goal]:255*p[goal]
 while changed
  local t:v.copy[].map[minusone]
  local n:v.copy[]
  each delta in tmove
   n.merge["|" t.copy[].translate[delta]]
  end
  n.merge["*" p]
  changed:!n.pixels~v.pixels
  v:n
 end
 # walk the flood-filled matrix to extract a max-scent path
 # if the goal is unreachable, return 0:
 on getpath here do
  if (max v @ flip move + here)&p[here]
   local r:list here
   if etc.shuffle # choose randomly from among equal-scent trails
    while (255>count r)&!here~goal
     here:first extract orderby v @ value desc from flip random[move (-count move)]+here
     r:r,list here
    end
   else # choose first-visited from among equal-scent trails
    while (255>count r)&!here~goal
     here:first extract orderby v @ value desc from flip move+here
     r:r,list here
    end
   end
   r
  end
 end
 # accept a single start or a list of starts:
 if is_pair[start] getpath[start] else getpath@start end
end
module.find:on find start goal mask etc do
 local off:(0,0) unless mask.pos
 local cell:default_cell unless etc.cell
 on cell_to_scr x do if x flip off+(.5*cell)+cell*flip x end end # 0 | list-of-pair
 on cell_to_rel x do if x flip     (.5*cell)+cell*flip x end end # 0 | list-of-pair
 local sc:to_cell[start mask etc] # rect | pair | list of either
 local gc:to_cell[ goal mask etc] # rect | pair
 r:find_cell[sc gc mask etc]
 # result(s) will be in the same coordinate system as start(s):
 if     is_rect[start]  cell_to_scr[r]
 elseif is_pair[start]  cell_to_rel[r]
 else
  each v i in start
   if is_rect[v] cell_to_scr[r[i]] else cell_to_rel[r[i]] end
  end
 end
end

module.closest_cell:on closest_cell x tolerance mask etc do
 # find the closest passable cell on the mask to x,
 # using a search radius of 'tolerance', or return 0
 local cell :default_cell unless etc.cell # pair
 local block:(list 1) unless etc.block    # list
 local s:floor mask.size/cell
 on passable x do
  if (min x>-1)&(min x<s)
   !sum mask.copy[x*cell cell].hist @ block
  end
 end
 if passable[x] x else
  cells:((2*tolerance) cross (2*tolerance))-tolerance
  if etc.shuffle cells:random[cells (-count cells)] end
  grid:extract orderby mag@value asc from cells
  first extract where passable@value from flip x+flip grid
 end
end
module.closest:on closest start tolerance mask etc do
 local off:(0,0) unless mask.pos
 local cell:default_cell unless etc.cell
 on cell_to_scr x do if x off+(.5*cell)+cell*x end end # 0 | pair
 on cell_to_rel x do if x     (.5*cell)+cell*x end end # 0 | pair
 local sc:to_cell[start mask etc] # rect | pair
 local r:closest_cell[sc tolerance mask etc]
 # result will be in the same coordinate system as start:
 if is_rect[start] cell_to_scr[r] else cell_to_rel[r] end
end
{end}

{contraption:follower}
size:[100,100]
resizable:1
margin:[1,1,1,1]
description:"A semi-autonomous \"agent\" that can animate itself along a provided path of waypoints."
version:1.2
script:"follower.0p"
template:"on finish do end\non step do end\non tween t a b do end\non click do end\non release do end"
attributes:{"name":["sprite","speed","draggable"],"label":["Sprite","Frames per step","Draggable"],"type":["rich","number","bool"]}
{widgets}
c:{"type":"canvas","size":[100,100],"pos":[0,0],"locked":1,"volatile":1,"border":0,"scale":1}
si:{"type":"field","size":[100,20],"pos":[136,-38],"locked":1,"show":"none","value":{"text":["","i"],"font":["",""],"arg":["","%%IMG3ABAAEAZAgFAIKhaHyCEowGSCksqmMfCELptUKhRwxWq3Xec2Kh4TpeZzeRz+WrvXKrKddXO90jU9796j50aBR0JB"]}}
ss:{"type":"field","size":[100,20],"pos":[136,-11],"locked":1,"show":"none","style":"plain","value":"10"}
sd:{"type":"button","size":[100,20],"pos":[136,16],"locked":1,"show":"none","style":"check"}
sp:{"type":"field","size":[100,20],"pos":[136,43],"locked":1,"show":"none","style":"plain"}
sa:{"type":"field","size":[100,20],"pos":[136,69],"locked":1,"show":"none","border":0,"style":"plain"}

{script:follower.0p}
on get_animate do view end
on get_speed do 0+ss.text end
on set_speed x do ss.text:1|x end
on get_draggable do sd.value end
on set_draggable x do sd.value:x end
on get_sprite do si.value end
on set_sprite x do si.value:x update_view[] end
on get_aux do sa.data end
on set_aux x do sa.data:x end
on get_done do c.animated~0 end
on get_path do () unless sp.data.path end
on set_path x do
 if !x~() # animate along path
  sp.data:().path:x
  c.animated:x
 end
end
on click do
 if !card.locked
  card.event.click
  if get_draggable[] set_path[0] end
 end
end
on drag pos do
 if get_draggable[]&!card.locked
  card.pos:pointer.pos-c.size/2
  c.pos:0,0
 end
end
on release do
 if get_draggable[]&!card.locked
  card.event.release
 end
end
on update_view do
 i:first si.images
 c.clear[]
 c.paste[i .5*c.size-i.size]
 c.show:card.show
 c.draggable:get_draggable[]
end
on view do
 if c.animated&!card.locked
  fin:0
  stp:0
  s:sp.data
  if 1~count s.path # direct warp; no tween
   card.pos:(first s.path)-.5*card.size
   sp.data:().path:()
   c.animated:0
   fin:1
  elseif s.i>get_speed[]-1
   stp:1
   if s.s>(count s.path)-3
    c.animated:0
    s:()dict()
    fin:1
   else
    s.s:s.s+1
    s.i:0
   end
   sp.data:s
  else
   tt:s.i/get_speed[]-1
   ta:s.path[s.s]
   tb:s.path[s.s+1]
   s.i:s.i+1
   sp.data:s
   ct:card.event["tween" tt ta tb]
   t:if (ct~nil)|(ct~0) (ta+tt*tb-ta) else ct end
   card.pos:t-.5*card.size
  end
  if stp card.event.step   end
  if fin card.event.finish end
 end
 update_view[]
end
{end}

{contraption:scriptViewer}
size:[100,100]
resizable:1
margin:[3,20,3,3]
description:"a tabbed editor for viewing and editing the scripts of one or more widgets on the current card."
version:1
image:"%%IMG3AGQAZAZAgHBILBqPyKRyyWw6n9CodEqtWq/YrHbL7Xq/4LB4TC6bz+i0es1uu9/wuHxOr9vv+Pw7wO/7/4CBgoOEhYaHhCCKi4yNjo+QkZKTlJWPfJaZmpucnJidoKGimZ+jpqempairrJaqrbCxjK+ytay0trmjuLq9ngG+waG8wsWRxMbJs8DKzZDIzsbQ0cLT1L7W17rZ2rbc3bLf4LDi47fM5tLo6dXr7Nju79vx8t709eH3+OT6++f+8wDmKidQE8GCrvohFHVw4aSGDo8pjPiL4j+LqCBiXLbxlMaOID52FLmRJEaTFlFSVBmRpUOXC2EilFmQpkCbAHH607mPJz6f9YDKE/qOKDuj6ZCaUzqOKTin3aBqk3qNKjWr0bA609qMqzKvycCqA7lrIllJYoulbXd2mNm2lxDJnUu3rt0AQQA="
script:"scriptViewer.0p"
attributes:{"name":["options_text"],"label":["Sources"],"type":["code"]}
{widgets}
o:{"type":"field","size":[100,20],"pos":[123,1],"show":"none","style":"plain","value":"card"}
c:{"type":"canvas","size":[100,18],"pos":[0,0],"locked":1,"volatile":1,"pattern":32,"show":"transparent","border":0,"scale":1}
i:{"type":"slider","size":[100,25],"pos":[123,32],"show":"none","interval":[0,2]}
scr:{"type":"field","size":[96,79],"pos":[2,19],"volatile":1,"border":0,"scrollbar":1,"style":"code"}

{script:scriptViewer.0p}
on get_options_text do o.text end
on set_options_text x do
 o.text:x
 i.interval:0,(count "\n" split o.text)-1
 view[]
end
on get_options do "\n" split o.text end
on set_options x do set_options_text["\n" fuse x] x end
on get_value do get_options[][i.value] end
on set_value x do v:get_options[] i.value:sum (range count v)*v=x x view[] end

bf:image["%%IMG2AAsABwADAQUABQEBIAUBAQADAQEgBwEBAAEBASAJAQIgCQECIAkBDA=="] bb:image["%%IMG2AAsABwADAQUABQEBIAUBAQADAQEgAQEFIAEBAQABAQEgAQEHIAEBAiABAQcgAQECIAEBByABAQIgAQEHIAEBAQ=="]

on target do
 val:get_value[]
 if val~"deck" deck elseif val~"card" deck.card else deck.card.widgets[val] end
end
on change do
 target[].script:scr.text
end

on view do
 c.font:card.font
 c.clear[]
 v:get_options[]
 w:(.7*c.size[0])/count v
 each x ix in v
  sel:ix~i.value
  b:(ix*w),0,(w+ix<-1+count v),c.size[1]
  c.segment[(bf,bb)[sel] b 5,4,5,2]
  c.pattern:(1,32)[sel]
  c.text[x b+(0,1,0,0) "center"]
 end
 scr.text:target[].script
 scr.locked:card.locked
end

on click pos do
 v:get_options[]
 w:(.7*c.size[0])/count v
 set_value[v[floor(first pos)/w]]
end
{end}

